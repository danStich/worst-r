<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>17.2 Binary (logistic) regression | The Worst Stats Text eveR</title>
  <meta name="description" content="17.2 Binary (logistic) regression | The Worst Stats Text eveR" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="17.2 Binary (logistic) regression | The Worst Stats Text eveR" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="17.2 Binary (logistic) regression | The Worst Stats Text eveR" />
  
  
  

<meta name="author" content="Dan Stich" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="17-1-intro17.html"/>
<link rel="next" href="17-3-next17.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Worst Stats Text eveR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>The Worst Stats Text eveR</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="1" data-path="1-Chapter1.html"><a href="1-Chapter1.html"><i class="fa fa-check"></i><b>1</b> Introduction to programming in R</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-what-is-r.html"><a href="1-1-what-is-r.html"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="1-2-why-should-i-use-r.html"><a href="1-2-why-should-i-use-r.html"><i class="fa fa-check"></i><b>1.2</b> Why should I use R?</a></li>
<li class="chapter" data-level="1.3" data-path="1-3-where-do-i-start.html"><a href="1-3-where-do-i-start.html"><i class="fa fa-check"></i><b>1.3</b> Where do I start?</a></li>
<li class="chapter" data-level="1.4" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html"><i class="fa fa-check"></i><b>1.4</b> Programming conventions</a><ul>
<li class="chapter" data-level="" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html#style"><i class="fa fa-check"></i>Style and organization</a></li>
<li class="chapter" data-level="" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html#tips"><i class="fa fa-check"></i>Some handy coding tips</a></li>
<li class="chapter" data-level="" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html#rules"><i class="fa fa-check"></i>Stricter R programming rules</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1-5-next1.html"><a href="1-5-next1.html"><i class="fa fa-check"></i><b>1.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-Chapter2.html"><a href="2-Chapter2.html"><i class="fa fa-check"></i><b>2</b> Data structures</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-vectors.html"><a href="2-1-vectors.html"><i class="fa fa-check"></i><b>2.1</b> Vectors</a><ul>
<li class="chapter" data-level="" data-path="2-1-vectors.html"><a href="2-1-vectors.html#nums"><i class="fa fa-check"></i>Integers and numerics</a></li>
<li class="chapter" data-level="" data-path="2-1-vectors.html"><a href="2-1-vectors.html#strings"><i class="fa fa-check"></i>Characters and factors</a></li>
<li class="chapter" data-level="" data-path="2-1-vectors.html"><a href="2-1-vectors.html#logicals"><i class="fa fa-check"></i>Logical vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-2-operations.html"><a href="2-2-operations.html"><i class="fa fa-check"></i><b>2.2</b> Vector operations</a></li>
<li class="chapter" data-level="2.3" data-path="2-3-matrices.html"><a href="2-3-matrices.html"><i class="fa fa-check"></i><b>2.3</b> Matrices</a></li>
<li class="chapter" data-level="2.4" data-path="2-4-dataframes.html"><a href="2-4-dataframes.html"><i class="fa fa-check"></i><b>2.4</b> Dataframes</a></li>
<li class="chapter" data-level="2.5" data-path="2-5-lists.html"><a href="2-5-lists.html"><i class="fa fa-check"></i><b>2.5</b> Lists</a></li>
<li class="chapter" data-level="2.6" data-path="2-6-next2.html"><a href="2-6-next2.html"><i class="fa fa-check"></i><b>2.6</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-Chapter3.html"><a href="3-Chapter3.html"><i class="fa fa-check"></i><b>3</b> Working with data</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-data-read.html"><a href="3-1-data-read.html"><i class="fa fa-check"></i><b>3.1</b> Data read</a></li>
<li class="chapter" data-level="3.2" data-path="3-2-quick-data-summaries.html"><a href="3-2-quick-data-summaries.html"><i class="fa fa-check"></i><b>3.2</b> Quick data summaries</a></li>
<li class="chapter" data-level="3.3" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html"><i class="fa fa-check"></i><b>3.3</b> Subsetting and selecting data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html#manual-subsets-and-selections"><i class="fa fa-check"></i><b>3.3.1</b> Manual subsets and selections</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html#subsetting-and-summaries-in-base-r"><i class="fa fa-check"></i><b>3.3.2</b> Subsetting and summaries in base R</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html#tidyverse"><i class="fa fa-check"></i><b>3.3.3</b> Subsetting and summaries in the tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-4-better-data-summaries.html"><a href="3-4-better-data-summaries.html"><i class="fa fa-check"></i><b>3.4</b> Better data summaries</a></li>
<li class="chapter" data-level="3.5" data-path="3-5-creating-new-variables.html"><a href="3-5-creating-new-variables.html"><i class="fa fa-check"></i><b>3.5</b> Creating new variables</a></li>
<li class="chapter" data-level="3.6" data-path="3-6-data-simulation.html"><a href="3-6-data-simulation.html"><i class="fa fa-check"></i><b>3.6</b> Data simulation</a><ul>
<li class="chapter" data-level="3.6.1" data-path="3-6-data-simulation.html"><a href="3-6-data-simulation.html#random-sub-samples-from-a-dataset"><i class="fa fa-check"></i><b>3.6.1</b> Random sub-samples from a dataset</a></li>
<li class="chapter" data-level="3.6.2" data-path="3-6-data-simulation.html"><a href="3-6-data-simulation.html#stochastic"><i class="fa fa-check"></i><b>3.6.2</b> Stochastic simulation</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="3-7-next3.html"><a href="3-7-next3.html"><i class="fa fa-check"></i><b>3.7</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-Chapter4.html"><a href="4-Chapter4.html"><i class="fa fa-check"></i><b>4</b> Plotting and graphics</a><ul>
<li class="chapter" data-level="4.1" data-path="4-1-plots-matter-as-much-as-stats.html"><a href="4-1-plots-matter-as-much-as-stats.html"><i class="fa fa-check"></i><b>4.1</b> Plots matter as much as stats</a></li>
<li class="chapter" data-level="4.2" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html"><i class="fa fa-check"></i><b>4.2</b> Plotting with base R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#histograms"><i class="fa fa-check"></i><b>4.2.1</b> Histograms</a></li>
<li class="chapter" data-level="4.2.2" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#scatterplots"><i class="fa fa-check"></i><b>4.2.2</b> Scatterplots</a></li>
<li class="chapter" data-level="4.2.3" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#lines"><i class="fa fa-check"></i><b>4.2.3</b> Lines</a></li>
<li class="chapter" data-level="4.2.4" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#boxplots"><i class="fa fa-check"></i><b>4.2.4</b> Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>4.3</b> Plotting with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="4.3.1" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#gghists"><i class="fa fa-check"></i><b>4.3.1</b> Histograms</a></li>
<li class="chapter" data-level="4.3.2" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#ggscatter"><i class="fa fa-check"></i><b>4.3.2</b> Scatter plots</a></li>
<li class="chapter" data-level="4.3.3" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#gglines"><i class="fa fa-check"></i><b>4.3.3</b> Lines</a></li>
<li class="chapter" data-level="4.3.4" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#ggboxplots"><i class="fa fa-check"></i><b>4.3.4</b> Boxplots and</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4-4-next4.html"><a href="4-4-next4.html"><i class="fa fa-check"></i><b>4.4</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-Chapter5.html"><a href="5-Chapter5.html"><i class="fa fa-check"></i><b>5</b> Sampling distributions in R</a><ul>
<li class="chapter" data-level="5.1" data-path="5-1-what-are-sampling-distributions.html"><a href="5-1-what-are-sampling-distributions.html"><i class="fa fa-check"></i><b>5.1</b> What are sampling distributions?</a></li>
<li class="chapter" data-level="5.2" data-path="5-2-probability-distributions-in-r.html"><a href="5-2-probability-distributions-in-r.html"><i class="fa fa-check"></i><b>5.2</b> Probability distributions in R</a></li>
<li class="chapter" data-level="5.3" data-path="5-3-exponential-family.html"><a href="5-3-exponential-family.html"><i class="fa fa-check"></i><b>5.3</b> Exponential family</a></li>
<li class="chapter" data-level="5.4" data-path="5-4-continuous-distributions.html"><a href="5-4-continuous-distributions.html"><i class="fa fa-check"></i><b>5.4</b> Continuous distributions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="5-4-continuous-distributions.html"><a href="5-4-continuous-distributions.html#the-lognormal-distribution"><i class="fa fa-check"></i><b>5.4.1</b> The lognormal distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="5-4-continuous-distributions.html"><a href="5-4-continuous-distributions.html#the-beta-distribution"><i class="fa fa-check"></i><b>5.4.2</b> The beta distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html"><i class="fa fa-check"></i><b>5.5</b> Discrete distributions</a><ul>
<li class="chapter" data-level="5.5.1" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#bernoulli"><i class="fa fa-check"></i><b>5.5.1</b> Bernoulli</a></li>
<li class="chapter" data-level="5.5.2" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#binomial"><i class="fa fa-check"></i><b>5.5.2</b> Binomial</a></li>
<li class="chapter" data-level="5.5.3" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#multinomial"><i class="fa fa-check"></i><b>5.5.3</b> Multinomial</a></li>
<li class="chapter" data-level="5.5.4" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#poisson"><i class="fa fa-check"></i><b>5.5.4</b> Poisson</a></li>
<li class="chapter" data-level="5.5.5" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#the-negative-binomial-distribution"><i class="fa fa-check"></i><b>5.5.5</b> The negative binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="5-6-sample-statistics.html"><a href="5-6-sample-statistics.html"><i class="fa fa-check"></i><b>5.6</b> Sample statistics</a><ul>
<li class="chapter" data-level="5.6.1" data-path="5-6-sample-statistics.html"><a href="5-6-sample-statistics.html#moments-about-the-mean"><i class="fa fa-check"></i><b>5.6.1</b> Moments about the mean</a></li>
<li class="chapter" data-level="5.6.2" data-path="5-6-sample-statistics.html"><a href="5-6-sample-statistics.html#estimating-parameters-of-the-normal-distribution-from-a-sample"><i class="fa fa-check"></i><b>5.6.2</b> Estimating parameters of the normal distribution from a sample</a></li>
<li class="chapter" data-level="5.6.3" data-path="5-6-sample-statistics.html"><a href="5-6-sample-statistics.html#quantiles-and-other-descriptive-statistics"><i class="fa fa-check"></i><b>5.6.3</b> Quantiles and other descriptive statistics</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="5-7-next5.html"><a href="5-7-next5.html"><i class="fa fa-check"></i><b>5.7</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-Chapter6.html"><a href="6-Chapter6.html"><i class="fa fa-check"></i><b>6</b> Inferential statistics</a><ul>
<li class="chapter" data-level="6.1" data-path="6-1-one-sample-tests.html"><a href="6-1-one-sample-tests.html"><i class="fa fa-check"></i><b>6.1</b> One-sample tests</a><ul>
<li class="chapter" data-level="6.1.1" data-path="6-1-one-sample-tests.html"><a href="6-1-one-sample-tests.html#one-sample-t-test"><i class="fa fa-check"></i><b>6.1.1</b> One sample t-test</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-1-one-sample-tests.html"><a href="6-1-one-sample-tests.html#wilcox-test"><i class="fa fa-check"></i><b>6.1.2</b> Wilcox test</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-2-two-sample-tests.html"><a href="6-2-two-sample-tests.html"><i class="fa fa-check"></i><b>6.2</b> Two-sample tests</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-2-two-sample-tests.html"><a href="6-2-two-sample-tests.html#the-two-sample-t-test"><i class="fa fa-check"></i><b>6.2.1</b> The two-sample t-test</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-2-two-sample-tests.html"><a href="6-2-two-sample-tests.html#two-sample-wilcox-test"><i class="fa fa-check"></i><b>6.2.2</b> Two-sample Wilcox test</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-2-two-sample-tests.html"><a href="6-2-two-sample-tests.html#presenting-your-results"><i class="fa fa-check"></i><b>6.2.3</b> Presenting your results</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-3-frequency-analysis.html"><a href="6-3-frequency-analysis.html"><i class="fa fa-check"></i><b>6.3</b> Frequency analysis</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-3-frequency-analysis.html"><a href="6-3-frequency-analysis.html#worked-example"><i class="fa fa-check"></i><b>6.3.1</b> Worked example</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-4-next6.html"><a href="6-4-next6.html"><i class="fa fa-check"></i><b>6.4</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-Chapter7.html"><a href="7-Chapter7.html"><i class="fa fa-check"></i><b>7</b> Linear models</a><ul>
<li class="chapter" data-level="7.1" data-path="7-1-anova.html"><a href="7-1-anova.html"><i class="fa fa-check"></i><b>7.1</b> Analysis of variance (ANOVA)</a><ul>
<li class="chapter" data-level="7.1.1" data-path="7-1-anova.html"><a href="7-1-anova.html#one-way"><i class="fa fa-check"></i><b>7.1.1</b> One-way analysis of variance</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-1-anova.html"><a href="7-1-anova.html#twon-way-anova"><i class="fa fa-check"></i><b>7.1.2</b> Two(<em>n</em>)-way ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-2-simple-linear-regression.html"><a href="7-2-simple-linear-regression.html"><i class="fa fa-check"></i><b>7.2</b> Simple linear regression</a><ul>
<li class="chapter" data-level="7.2.1" data-path="7-2-simple-linear-regression.html"><a href="7-2-simple-linear-regression.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>7.2.1</b> Simple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7-3-multiple-linear-regression.html"><a href="7-3-multiple-linear-regression.html"><i class="fa fa-check"></i><b>7.3</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.4" data-path="7-4-next7.html"><a href="7-4-next7.html"><i class="fa fa-check"></i><b>7.4</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-Chapter8.html"><a href="8-Chapter8.html"><i class="fa fa-check"></i><b>8</b> General linear models</a><ul>
<li class="chapter" data-level="8.1" data-path="8-1-analysis-of-covariance-ancova.html"><a href="8-1-analysis-of-covariance-ancova.html"><i class="fa fa-check"></i><b>8.1</b> Analysis of covariance (ANCOVA)</a></li>
<li class="chapter" data-level="8.2" data-path="8-2-motivation.html"><a href="8-2-motivation.html"><i class="fa fa-check"></i><b>8.2</b> Motivation</a></li>
<li class="chapter" data-level="8.3" data-path="8-3-data.html"><a href="8-3-data.html"><i class="fa fa-check"></i><b>8.3</b> Data</a></li>
<li class="chapter" data-level="8.4" data-path="8-4-analysis.html"><a href="8-4-analysis.html"><i class="fa fa-check"></i><b>8.4</b> Analysis</a></li>
<li class="chapter" data-level="8.5" data-path="8-5-predictions.html"><a href="8-5-predictions.html"><i class="fa fa-check"></i><b>8.5</b> Predictions</a></li>
<li class="chapter" data-level="8.6" data-path="8-6-next8.html"><a href="8-6-next8.html"><i class="fa fa-check"></i><b>8.6</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-Chapter9.html"><a href="9-Chapter9.html"><i class="fa fa-check"></i><b>9</b> Assumptions of linear models</a><ul>
<li class="chapter" data-level="9.1" data-path="9-1-intro9.html"><a href="9-1-intro9.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="9-2-assumptions-of-linear-models.html"><a href="9-2-assumptions-of-linear-models.html"><i class="fa fa-check"></i><b>9.2</b> Assumptions of linear models</a></li>
<li class="chapter" data-level="9.3" data-path="9-3-ughmath.html"><a href="9-3-ughmath.html"><i class="fa fa-check"></i><b>9.3</b> WTF is a residuals?</a><ul>
<li class="chapter" data-level="9.3.1" data-path="9-3-ughmath.html"><a href="9-3-ughmath.html#residuals-in-anova"><i class="fa fa-check"></i><b>9.3.1</b> Residuals in ANOVA</a></li>
<li class="chapter" data-level="9.3.2" data-path="9-3-ughmath.html"><a href="9-3-ughmath.html#residuals-in-linear-regression"><i class="fa fa-check"></i><b>9.3.2</b> Residuals in linear regression</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9-4-the-turtle-problem.html"><a href="9-4-the-turtle-problem.html"><i class="fa fa-check"></i><b>9.4</b> The turtle problem</a></li>
<li class="chapter" data-level="9.5" data-path="9-5-data-exploration.html"><a href="9-5-data-exploration.html"><i class="fa fa-check"></i><b>9.5</b> Data exploration</a><ul>
<li class="chapter" data-level="9.5.1" data-path="9-5-data-exploration.html"><a href="9-5-data-exploration.html#independence-of-observations"><i class="fa fa-check"></i><b>9.5.1</b> Independence of observations</a></li>
<li class="chapter" data-level="9.5.2" data-path="6-2-two-sample-tests.html"><a href="6-2-two-sample-tests.html#normality"><i class="fa fa-check"></i><b>9.5.2</b> Normality</a></li>
<li class="chapter" data-level="9.5.3" data-path="9-5-data-exploration.html"><a href="9-5-data-exploration.html#homogeneity-of-variances"><i class="fa fa-check"></i><b>9.5.3</b> Homogeneity of variances</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="9-6-anova-diagnostics.html"><a href="9-6-anova-diagnostics.html"><i class="fa fa-check"></i><b>9.6</b> ANOVA Diagnostics</a></li>
<li class="chapter" data-level="9.7" data-path="9-7-linear-regression-diagnostics.html"><a href="9-7-linear-regression-diagnostics.html"><i class="fa fa-check"></i><b>9.7</b> Linear regression diagnostics</a></li>
<li class="chapter" data-level="9.8" data-path="9-8-next9.html"><a href="9-8-next9.html"><i class="fa fa-check"></i><b>9.8</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-Chapter10.html"><a href="10-Chapter10.html"><i class="fa fa-check"></i><b>10</b> Communicating effect sizes</a><ul>
<li class="chapter" data-level="10.1" data-path="10-1-one-way-anova.html"><a href="10-1-one-way-anova.html"><i class="fa fa-check"></i><b>10.1</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="10.1.1" data-path="10-1-one-way-anova.html"><a href="10-1-one-way-anova.html#unifying-the-linear-model"><i class="fa fa-check"></i><b>10.1.1</b> Unifying the linear model</a></li>
<li class="chapter" data-level="10.1.2" data-path="10-1-one-way-anova.html"><a href="10-1-one-way-anova.html#the-model-matrix"><i class="fa fa-check"></i><b>10.1.2</b> The model matrix</a></li>
<li class="chapter" data-level="10.1.3" data-path="10-1-one-way-anova.html"><a href="10-1-one-way-anova.html#prediction"><i class="fa fa-check"></i><b>10.1.3</b> Prediction</a></li>
<li class="chapter" data-level="10.1.4" data-path="10-1-one-way-anova.html"><a href="10-1-one-way-anova.html#plotting"><i class="fa fa-check"></i><b>10.1.4</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10-2-two-way-anova.html"><a href="10-2-two-way-anova.html"><i class="fa fa-check"></i><b>10.2</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="10.2.1" data-path="10-2-two-way-anova.html"><a href="10-2-two-way-anova.html#main-effects-10"><i class="fa fa-check"></i><b>10.2.1</b> Main effects model</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-2-two-way-anova.html"><a href="10-2-two-way-anova.html#interactions"><i class="fa fa-check"></i><b>10.2.2</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-3-linear-regression.html"><a href="10-3-linear-regression.html"><i class="fa fa-check"></i><b>10.3</b> Linear regression</a><ul>
<li class="chapter" data-level="10.3.1" data-path="10-3-linear-regression.html"><a href="10-3-linear-regression.html#prediction-1"><i class="fa fa-check"></i><b>10.3.1</b> Prediction</a></li>
<li class="chapter" data-level="10.3.2" data-path="10-3-linear-regression.html"><a href="10-3-linear-regression.html#plotting-1"><i class="fa fa-check"></i><b>10.3.2</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10-4-ancova.html"><a href="10-4-ancova.html"><i class="fa fa-check"></i><b>10.4</b> ANCOVA</a><ul>
<li class="chapter" data-level="10.4.1" data-path="10-4-ancova.html"><a href="10-4-ancova.html#prediction-2"><i class="fa fa-check"></i><b>10.4.1</b> Prediction</a></li>
<li class="chapter" data-level="10.4.2" data-path="10-4-ancova.html"><a href="10-4-ancova.html#plotting-2"><i class="fa fa-check"></i><b>10.4.2</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="10-5-next10.html"><a href="10-5-next10.html"><i class="fa fa-check"></i><b>10.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-Chapter11.html"><a href="11-Chapter11.html"><i class="fa fa-check"></i><b>11</b> Model selection</a><ul>
<li class="chapter" data-level="11.1" data-path="11-1-intro11.html"><a href="11-1-intro11.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="11-2-model-selection-tools.html"><a href="11-2-model-selection-tools.html"><i class="fa fa-check"></i><b>11.2</b> Model selection tools</a></li>
<li class="chapter" data-level="11.3" data-path="11-3-all-subsets.html"><a href="11-3-all-subsets.html"><i class="fa fa-check"></i><b>11.3</b> All subsets</a></li>
<li class="chapter" data-level="11.4" data-path="11-4-stepwise.html"><a href="11-4-stepwise.html"><i class="fa fa-check"></i><b>11.4</b> Stepwise selection</a><ul>
<li class="chapter" data-level="11.4.1" data-path="11-4-stepwise.html"><a href="11-4-stepwise.html#forward-selection"><i class="fa fa-check"></i><b>11.4.1</b> Forward selection</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="11-5-a-priori.html"><a href="11-5-a-priori.html"><i class="fa fa-check"></i><b>11.5</b> <em>A priori</em> selection</a><ul>
<li class="chapter" data-level="11.5.1" data-path="11-5-a-priori.html"><a href="11-5-a-priori.html#multi-phase-heirarchical-selection"><i class="fa fa-check"></i><b>11.5.1</b> Multi-phase (heirarchical) selection</a></li>
<li class="chapter" data-level="11.5.2" data-path="11-5-a-priori.html"><a href="11-5-a-priori.html#single-phase-selection"><i class="fa fa-check"></i><b>11.5.2</b> Single-phase selection</a></li>
<li class="chapter" data-level="11.5.3" data-path="11-5-a-priori.html"><a href="11-5-a-priori.html#tools-for-a-priori-model-selection"><i class="fa fa-check"></i><b>11.5.3</b> Tools for <em>a priori</em> model selection</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="11-6-model-validation.html"><a href="11-6-model-validation.html"><i class="fa fa-check"></i><b>11.6</b> Model validation</a><ul>
<li class="chapter" data-level="11.6.1" data-path="11-6-model-validation.html"><a href="11-6-model-validation.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>11.6.1</b> Leave-one-out cross validation</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="11-7-next11.html"><a href="11-7-next11.html"><i class="fa fa-check"></i><b>11.7</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-Chapter12.html"><a href="12-Chapter12.html"><i class="fa fa-check"></i><b>12</b> Logistic regression</a><ul>
<li class="chapter" data-level="12.1" data-path="12-1-intro12.html"><a href="12-1-intro12.html"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="12-2-Assumptions12.html"><a href="12-2-Assumptions12.html"><i class="fa fa-check"></i><b>12.2</b> Assumptions of linear models</a><ul>
<li class="chapter" data-level="12.2.1" data-path="12-2-Assumptions12.html"><a href="12-2-Assumptions12.html#assumption-1-normality-of-residuals"><i class="fa fa-check"></i><b>12.2.1</b> Assumption 1: normality of residuals</a></li>
<li class="chapter" data-level="12.2.2" data-path="12-2-Assumptions12.html"><a href="12-2-Assumptions12.html#assumption-2-independence-of-observations"><i class="fa fa-check"></i><b>12.2.2</b> Assumption 2: independence of observations</a></li>
<li class="chapter" data-level="12.2.3" data-path="12-2-Assumptions12.html"><a href="12-2-Assumptions12.html#assumption-3-homogeneity-of-variances"><i class="fa fa-check"></i><b>12.2.3</b> Assumption 3: homogeneity of variances</a></li>
<li class="chapter" data-level="12.2.4" data-path="12-2-Assumptions12.html"><a href="12-2-Assumptions12.html#assumption-4-linearity-and-additivity"><i class="fa fa-check"></i><b>12.2.4</b> Assumption 4: linearity and additivity</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="12-3-introducing-the-glm.html"><a href="12-3-introducing-the-glm.html"><i class="fa fa-check"></i><b>12.3</b> Introducing the GLM</a></li>
<li class="chapter" data-level="12.4" data-path="12-4-logistic.html"><a href="12-4-logistic.html"><i class="fa fa-check"></i><b>12.4</b> Binary (logistic) regression</a><ul>
<li class="chapter" data-level="12.4.1" data-path="12-4-logistic.html"><a href="12-4-logistic.html#data-explanation"><i class="fa fa-check"></i><b>12.4.1</b> Data Explanation</a></li>
<li class="chapter" data-level="12.4.2" data-path="12-4-logistic.html"><a href="12-4-logistic.html#data-analysis"><i class="fa fa-check"></i><b>12.4.2</b> Data analysis</a></li>
<li class="chapter" data-level="12.4.3" data-path="12-4-logistic.html"><a href="12-4-logistic.html#interpreting-the-results"><i class="fa fa-check"></i><b>12.4.3</b> Interpreting the results</a></li>
<li class="chapter" data-level="12.4.4" data-path="12-4-logistic.html"><a href="12-4-logistic.html#making-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Making predictions</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="12-5-next12.html"><a href="12-5-next12.html"><i class="fa fa-check"></i><b>12.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-Chapter13.html"><a href="13-Chapter13.html"><i class="fa fa-check"></i><b>13</b> GLM: Count models</a><ul>
<li class="chapter" data-level="13.1" data-path="13-1-intro13.html"><a href="13-1-intro13.html"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="13-2-poisson-13.html"><a href="13-2-poisson-13.html"><i class="fa fa-check"></i><b>13.2</b> Poisson regression</a><ul>
<li class="chapter" data-level="13.2.1" data-path="13-2-poisson-13.html"><a href="13-2-poisson-13.html#data-13"><i class="fa fa-check"></i><b>13.2.1</b> Data explanation</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="13-3-negbin.html"><a href="13-3-negbin.html"><i class="fa fa-check"></i><b>13.3</b> Negative binomial regression</a></li>
<li class="chapter" data-level="13.4" data-path="13-4-zinf-13.html"><a href="13-4-zinf-13.html"><i class="fa fa-check"></i><b>13.4</b> Zero inflation</a><ul>
<li class="chapter" data-level="13.4.1" data-path="13-4-zinf-13.html"><a href="13-4-zinf-13.html#predict-13"><i class="fa fa-check"></i><b>13.4.1</b> Predictions</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="13-5-next-13.html"><a href="13-5-next-13.html"><i class="fa fa-check"></i><b>13.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="14-Chapter14.html"><a href="14-Chapter14.html"><i class="fa fa-check"></i><b>14</b> Linear mixed models</a><ul>
<li class="chapter" data-level="14.1" data-path="14-1-intro-14.html"><a href="14-1-intro-14.html"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="14-2-assumptions-lmm.html"><a href="14-2-assumptions-lmm.html"><i class="fa fa-check"></i><b>14.2</b> Assumptions of linear models</a><ul>
<li class="chapter" data-level="14.2.1" data-path="14-2-assumptions-lmm.html"><a href="14-2-assumptions-lmm.html#normality-14"><i class="fa fa-check"></i><b>14.2.1</b> Assumption 1: Normality of residuals</a></li>
<li class="chapter" data-level="14.2.2" data-path="14-2-assumptions-lmm.html"><a href="14-2-assumptions-lmm.html#independence-14"><i class="fa fa-check"></i><b>14.2.2</b> Assumption 2: Independence of observations</a></li>
<li class="chapter" data-level="14.2.3" data-path="14-2-assumptions-lmm.html"><a href="14-2-assumptions-lmm.html#homogeneity-14"><i class="fa fa-check"></i><b>14.2.3</b> Assumption 3: Homogeneity of variances</a></li>
<li class="chapter" data-level="14.2.4" data-path="14-2-assumptions-lmm.html"><a href="14-2-assumptions-lmm.html#linearity-14"><i class="fa fa-check"></i><b>14.2.4</b> Assumption 4: Linearity and additivity</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="14-3-linear-mixed-models.html"><a href="14-3-linear-mixed-models.html"><i class="fa fa-check"></i><b>14.3</b> Linear mixed models</a></li>
<li class="chapter" data-level="14.4" data-path="14-4-lmm-worked.html"><a href="14-4-lmm-worked.html"><i class="fa fa-check"></i><b>14.4</b> Worked example</a><ul>
<li class="chapter" data-level="14.4.1" data-path="14-4-lmm-worked.html"><a href="14-4-lmm-worked.html#random-intercepts-model"><i class="fa fa-check"></i><b>14.4.1</b> Random-intercepts model</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="14-5-next-14.html"><a href="14-5-next-14.html"><i class="fa fa-check"></i><b>14.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-Chapter15.html"><a href="15-Chapter15.html"><i class="fa fa-check"></i><b>15</b> Generalized linear mixed models</a><ul>
<li class="chapter" data-level="15.1" data-path="15-1-intro-15.html"><a href="15-1-intro-15.html"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="15-2-glmm-logistic.html"><a href="15-2-glmm-logistic.html"><i class="fa fa-check"></i><b>15.2</b> Logistic regression</a><ul>
<li class="chapter" data-level="15.2.1" data-path="15-2-glmm-logistic.html"><a href="15-2-glmm-logistic.html#glmm-logistic-data"><i class="fa fa-check"></i><b>15.2.1</b> Data Explanation</a></li>
<li class="chapter" data-level="15.2.2" data-path="15-2-glmm-logistic.html"><a href="15-2-glmm-logistic.html#glmm-logistic-analysis"><i class="fa fa-check"></i><b>15.2.2</b> Data analysis</a></li>
<li class="chapter" data-level="15.2.3" data-path="15-2-glmm-logistic.html"><a href="15-2-glmm-logistic.html#glmm-logistic-preds"><i class="fa fa-check"></i><b>15.2.3</b> Predictions</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="15-3-glmm-count.html"><a href="15-3-glmm-count.html"><i class="fa fa-check"></i><b>15.3</b> Count models</a><ul>
<li class="chapter" data-level="15.3.1" data-path="15-3-glmm-count.html"><a href="15-3-glmm-count.html#data-explanation-glmm-count-data"><i class="fa fa-check"></i><b>15.3.1</b> Data explanation {glmm-count-data}</a></li>
<li class="chapter" data-level="15.3.2" data-path="15-3-glmm-count.html"><a href="15-3-glmm-count.html#glmm-count-analysis"><i class="fa fa-check"></i><b>15.3.2</b> Data analysis</a></li>
<li class="chapter" data-level="15.3.3" data-path="15-3-glmm-count.html"><a href="15-3-glmm-count.html#glmm-count-preds"><i class="fa fa-check"></i><b>15.3.3</b> Predictions</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="15-4-next-15.html"><a href="15-4-next-15.html"><i class="fa fa-check"></i><b>15.4</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="16-introduction-to-bayesian-inference.html"><a href="16-introduction-to-bayesian-inference.html"><i class="fa fa-check"></i><b>16</b> Introduction to Bayesian inference</a><ul>
<li class="chapter" data-level="16.1" data-path="16-1-intro-16.html"><a href="16-1-intro-16.html"><i class="fa fa-check"></i><b>16.1</b> Introduction</a><ul>
<li class="chapter" data-level="16.1.1" data-path="16-1-intro-16.html"><a href="16-1-intro-16.html#installing-rstan"><i class="fa fa-check"></i><b>16.1.1</b> Installing RStan</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="16-2-intro-to-bayes-theorem.html"><a href="16-2-intro-to-bayes-theorem.html"><i class="fa fa-check"></i><b>16.2</b> Intro to Bayes Theorem</a></li>
<li class="chapter" data-level="16.3" data-path="16-3-the-prior.html"><a href="16-3-the-prior.html"><i class="fa fa-check"></i><b>16.3</b> The prior</a><ul>
<li class="chapter" data-level="16.3.1" data-path="16-3-the-prior.html"><a href="16-3-the-prior.html#the-hospital-example"><i class="fa fa-check"></i><b>16.3.1</b> The hospital example</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="16-4-the-posterior.html"><a href="16-4-the-posterior.html"><i class="fa fa-check"></i><b>16.4</b> The posterior</a></li>
<li class="chapter" data-level="16.5" data-path="16-5-worked-example-with-the-cray-data.html"><a href="16-5-worked-example-with-the-cray-data.html"><i class="fa fa-check"></i><b>16.5</b> Worked example with the Cray data</a></li>
<li class="chapter" data-level="16.6" data-path="16-6-running-a-bayesian-model-with-rstanarm.html"><a href="16-6-running-a-bayesian-model-with-rstanarm.html"><i class="fa fa-check"></i><b>16.6</b> Running a Bayesian model with <code>rstanarm</code></a><ul>
<li class="chapter" data-level="16.6.1" data-path="16-6-running-a-bayesian-model-with-rstanarm.html"><a href="16-6-running-a-bayesian-model-with-rstanarm.html#interpreting-the-model-summary"><i class="fa fa-check"></i><b>16.6.1</b> Interpreting the model summary</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="16-7-more-diagnostics.html"><a href="16-7-more-diagnostics.html"><i class="fa fa-check"></i><b>16.7</b> More diagnostics</a><ul>
<li class="chapter" data-level="16.7.1" data-path="16-7-more-diagnostics.html"><a href="16-7-more-diagnostics.html#trace-plots"><i class="fa fa-check"></i><b>16.7.1</b> Trace plots</a></li>
<li class="chapter" data-level="16.7.2" data-path="16-7-more-diagnostics.html"><a href="16-7-more-diagnostics.html#colinearity"><i class="fa fa-check"></i><b>16.7.2</b> Colinearity</a></li>
<li class="chapter" data-level="16.7.3" data-path="16-7-more-diagnostics.html"><a href="16-7-more-diagnostics.html#divergence"><i class="fa fa-check"></i><b>16.7.3</b> Divergence</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="16-8-bayesian-model-selection.html"><a href="16-8-bayesian-model-selection.html"><i class="fa fa-check"></i><b>16.8</b> Model selection</a></li>
<li class="chapter" data-level="16.9" data-path="16-9-summarizing-results.html"><a href="16-9-summarizing-results.html"><i class="fa fa-check"></i><b>16.9</b> Summarizing results</a></li>
<li class="chapter" data-level="16.10" data-path="12-4-logistic.html"><a href="12-4-logistic.html#making-predictions"><i class="fa fa-check"></i><b>16.10</b> Making predictions</a></li>
<li class="chapter" data-level="16.11" data-path="16-11-next-16.html"><a href="16-11-next-16.html"><i class="fa fa-check"></i><b>16.11</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="17-Chapter17.html"><a href="17-Chapter17.html"><i class="fa fa-check"></i><b>17</b> Bayesian Logistic regression</a><ul>
<li class="chapter" data-level="17.1" data-path="17-1-intro17.html"><a href="17-1-intro17.html"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="17-2-logistic-17.html"><a href="17-2-logistic-17.html"><i class="fa fa-check"></i><b>17.2</b> Binary (logistic) regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="17-2-logistic-17.html"><a href="17-2-logistic-17.html#data-17"><i class="fa fa-check"></i><b>17.2.1</b> Data Explanation</a></li>
<li class="chapter" data-level="17.2.2" data-path="17-2-logistic-17.html"><a href="17-2-logistic-17.html#analysis-17"><i class="fa fa-check"></i><b>17.2.2</b> Data analysis</a></li>
<li class="chapter" data-level="17.2.3" data-path="17-2-logistic-17.html"><a href="17-2-logistic-17.html#interpretting-17"><i class="fa fa-check"></i><b>17.2.3</b> Interpreting the results</a></li>
<li class="chapter" data-level="17.2.4" data-path="17-2-logistic-17.html"><a href="17-2-logistic-17.html#continuous-17"><i class="fa fa-check"></i><b>17.2.4</b> Continuous effects</a></li>
<li class="chapter" data-level="17.2.5" data-path="17-2-logistic-17.html"><a href="17-2-logistic-17.html#predictions-17"><i class="fa fa-check"></i><b>17.2.5</b> Making predictions</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="17-3-next17.html"><a href="17-3-next17.html"><i class="fa fa-check"></i><b>17.3</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="18-Chapter18.html"><a href="18-Chapter18.html"><i class="fa fa-check"></i><b>18</b> GLM: Count models</a><ul>
<li class="chapter" data-level="18.1" data-path="18-1-intro18.html"><a href="18-1-intro18.html"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="18-2-poisson-18.html"><a href="18-2-poisson-18.html"><i class="fa fa-check"></i><b>18.2</b> Poisson regression</a><ul>
<li class="chapter" data-level="18.2.1" data-path="18-2-poisson-18.html"><a href="18-2-poisson-18.html#data-18"><i class="fa fa-check"></i><b>18.2.1</b> Data explanation</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="18-3-negbin-18.html"><a href="18-3-negbin-18.html"><i class="fa fa-check"></i><b>18.3</b> Negative binomial regression</a></li>
<li class="chapter" data-level="18.4" data-path="18-4-zinfl-18.html"><a href="18-4-zinfl-18.html"><i class="fa fa-check"></i><b>18.4</b> Zero inflation</a><ul>
<li class="chapter" data-level="18.4.1" data-path="18-4-zinfl-18.html"><a href="18-4-zinfl-18.html#step-1-presence-absence"><i class="fa fa-check"></i><b>18.4.1</b> Step 1: Presence-absence</a></li>
<li class="chapter" data-level="18.4.2" data-path="18-4-zinfl-18.html"><a href="18-4-zinfl-18.html#step-2-counts-given-presence"><i class="fa fa-check"></i><b>18.4.2</b> Step 2: Counts given presence</a></li>
<li class="chapter" data-level="18.4.3" data-path="18-4-zinfl-18.html"><a href="18-4-zinfl-18.html#predict-counts"><i class="fa fa-check"></i><b>18.4.3</b> Predictions</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="18-5-next-steps.html"><a href="18-5-next-steps.html"><i class="fa fa-check"></i><b>18.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="19-Chapter19.html"><a href="19-Chapter19.html"><i class="fa fa-check"></i><b>19</b> Bayesian hierarchical models</a><ul>
<li class="chapter" data-level="19.1" data-path="19-1-intro-19.html"><a href="19-1-intro-19.html"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="19-2-hierarchical.html"><a href="19-2-hierarchical.html"><i class="fa fa-check"></i><b>19.2</b> Bayesian hierarchical models</a></li>
<li class="chapter" data-level="19.3" data-path="19-3-worked-19.html"><a href="19-3-worked-19.html"><i class="fa fa-check"></i><b>19.3</b> Worked example</a><ul>
<li class="chapter" data-level="19.3.1" data-path="19-3-worked-19.html"><a href="19-3-worked-19.html#random-intercept-19"><i class="fa fa-check"></i><b>19.3.1</b> Random-intercepts model</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="19-4-next-19.html"><a href="19-4-next-19.html"><i class="fa fa-check"></i><b>19.4</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="20-Chapter20.html"><a href="20-Chapter20.html"><i class="fa fa-check"></i><b>20</b> Bayesian hierarchical GLM</a><ul>
<li class="chapter" data-level="20.1" data-path="20-1-intro-20.html"><a href="20-1-intro-20.html"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="20-2-logistic-regression-20-logistic.html"><a href="20-2-logistic-regression-20-logistic.html"><i class="fa fa-check"></i><b>20.2</b> Logistic regression {#20-logistic}</a><ul>
<li class="chapter" data-level="20.2.1" data-path="20-2-logistic-regression-20-logistic.html"><a href="20-2-logistic-regression-20-logistic.html#data-explanation-20-logistic-data"><i class="fa fa-check"></i><b>20.2.1</b> Data Explanation {#20-logistic-data}</a></li>
<li class="chapter" data-level="20.2.2" data-path="20-2-logistic-regression-20-logistic.html"><a href="20-2-logistic-regression-20-logistic.html#data-analysis-20-logistic-analysis"><i class="fa fa-check"></i><b>20.2.2</b> Data analysis {#20-logistic-analysis}</a></li>
<li class="chapter" data-level="20.2.3" data-path="20-2-logistic-regression-20-logistic.html"><a href="20-2-logistic-regression-20-logistic.html#predictions-20-logistic-preds"><i class="fa fa-check"></i><b>20.2.3</b> Predictions {#20-logistic-preds}</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="20-3-count-models-20-count.html"><a href="20-3-count-models-20-count.html"><i class="fa fa-check"></i><b>20.3</b> Count models {#20-count}</a><ul>
<li class="chapter" data-level="20.3.1" data-path="20-3-count-models-20-count.html"><a href="20-3-count-models-20-count.html#data-explanation-20-count-data"><i class="fa fa-check"></i><b>20.3.1</b> Data explanation {20-count-data}</a></li>
<li class="chapter" data-level="20.3.2" data-path="20-3-count-models-20-count.html"><a href="20-3-count-models-20-count.html#data-analysis-20-count-analysis"><i class="fa fa-check"></i><b>20.3.2</b> Data analysis {#20-count-analysis}</a></li>
<li class="chapter" data-level="20.3.3" data-path="20-3-count-models-20-count.html"><a href="20-3-count-models-20-count.html#predictions-20-count-preds"><i class="fa fa-check"></i><b>20.3.3</b> Predictions {#20-count-preds}</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="20-4-next-20.html"><a href="20-4-next-20.html"><i class="fa fa-check"></i><b>20.4</b> Next steps</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Worst Stats Text eveR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-17" class="section level2">
<h2><span class="header-section-number">17.2</span> Binary (logistic) regression</h2>
<p>Here, we will duplicate the analysis from <a href="https://danstich.github.io/worst-r/12-Chapter12.html">Chapter 12</a> using a Bayesian framework with the <code>rstanarm</code> package. We’ll note some differences and some similarities as we go along.</p>
<p>Read in the data file.</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="17-2-logistic-17.html#cb636-1"></a>choice &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/StillwaterChoiceData.csv&quot;</span>)</span></code></pre></div>
<p>Look at the first few rows of data:</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="17-2-logistic-17.html#cb637-1"></a><span class="kw">head</span>(choice)</span></code></pre></div>
<pre><code>##   path year hatchery length mass date flow
## 1    0 2010        1    176   57  118  345
## 2    0 2005        1    205  101  128 1093
## 3    0 2010        1    180   56  118  345
## 4    0 2010        1    193   74  118  345
## 5    0 2005        1    189   76  128 1093
## 6    0 2010        1    180   65  118  345</code></pre>
<div id="data-17" class="section level3">
<h3><span class="header-section-number">17.2.1</span> Data Explanation</h3>
<p>The full data explanation is provided in <a href="https://danstich.github.io/worst-r/12-4-logistic.html">Chapter 12.4</a> and will not be repeat it here. Go check it out if you need a reminder of what data are in there.</p>
</div>
<div id="analysis-17" class="section level3">
<h3><span class="header-section-number">17.2.2</span> Data analysis</h3>
<p>We are going to use the 1/0 binary data to estimate the effects of a number of covariates of interest on the probability that an individual fish used the Stillwater Branch for migration in each year of this study using logistic regression.</p>
<p>If our response, <code>path</code> is a binary variable where 1 = Stillwater and 0 = mainstem for each fish 1 to <em>n</em>, we can think of p(Stillwater Branch) as:</p>
<p><span class="math display">\[p(Stillwater) = \frac{\sum{path}}{n}\]</span></p>
<p>and the logit of p(Stillwater Branch) can assumed to be normally distributed with a mean of .</p>
<p><span class="math display">\[logit(p) = Normal(\mu, \sigma^{2})\]</span></p>
<p>Now that we know we are doing <em>more or less</em> the same thing as we were for linear models, let’s move on with fitting the model.</p>
<p>First, since we are interested in the fixed effects of year, and not the linear trend through time, we need to convert year to factor.</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="17-2-logistic-17.html#cb639-1"></a>choice<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">as.factor</span>(choice<span class="op">$</span>year)</span></code></pre></div>
<p>Now, if we want to test hypotheses about the influences of explanatory variables on the probability of using the Stillwater Branch, we could make models to represent those hypotheses. For example, if we wanted to test whether <code>flow</code> had a significant influence on <code>path</code> across <code>year</code>s, then we could build a model that looks like this:</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="17-2-logistic-17.html#cb640-1"></a>flow_mod &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>flow, </span>
<span id="cb640-2"><a href="17-2-logistic-17.html#cb640-2"></a>                     <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb640-3"><a href="17-2-logistic-17.html#cb640-3"></a>                     <span class="dt">data =</span> choice)</span></code></pre></div>
<p>We could make another model that investigates effects of <code>length</code> on <code>path</code> choice instead of flow:</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="17-2-logistic-17.html#cb641-1"></a>len_mod &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>length, </span>
<span id="cb641-2"><a href="17-2-logistic-17.html#cb641-2"></a>                     <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb641-3"><a href="17-2-logistic-17.html#cb641-3"></a>                     <span class="dt">data =</span> choice)</span></code></pre></div>
<p>Or a model that includes both with an annoying name:</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="17-2-logistic-17.html#cb642-1"></a>flow_len_mod &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>flow <span class="op">+</span><span class="st"> </span>length, </span>
<span id="cb642-2"><a href="17-2-logistic-17.html#cb642-2"></a>                     <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb642-3"><a href="17-2-logistic-17.html#cb642-3"></a>                     <span class="dt">data =</span> choice)</span></code></pre></div>
<p>We could look at these individually to determine variable-level significance using approaches demonstrated in <a href="https://danstich.github.io/worst-r/16-9-summarizing-results.html">Chapter 16.9</a>.</p>
<p><strong>First</strong>, let’s define a slightly more complex set of models based on <em>a priori</em> combinations of explanatory variables. Note that this is pretty much identical to how we do this for models fit with <code>glm()</code> except now we are using <code>stan_glm()</code> to fit the models!</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="17-2-logistic-17.html#cb643-1"></a><span class="co"># Make an empty list to hold the models</span></span>
<span id="cb643-2"><a href="17-2-logistic-17.html#cb643-2"></a>mods &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb643-3"><a href="17-2-logistic-17.html#cb643-3"></a></span>
<span id="cb643-4"><a href="17-2-logistic-17.html#cb643-4"></a><span class="co"># Now, add models to the list. Stop and think about what each one means.</span></span>
<span id="cb643-5"><a href="17-2-logistic-17.html#cb643-5"></a>mods[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>hatchery <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>flow, <span class="dt">family =</span> binomial, <span class="dt">data =</span> choice)</span>
<span id="cb643-6"><a href="17-2-logistic-17.html#cb643-6"></a>mods[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>flow, <span class="dt">family =</span> binomial, <span class="dt">data =</span> choice)</span>
<span id="cb643-7"><a href="17-2-logistic-17.html#cb643-7"></a>mods[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>hatchery, <span class="dt">family =</span> binomial, <span class="dt">data =</span> choice)</span>
<span id="cb643-8"><a href="17-2-logistic-17.html#cb643-8"></a>mods[[<span class="dv">4</span>]] &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>length, <span class="dt">family =</span> binomial, <span class="dt">data =</span> choice)</span>
<span id="cb643-9"><a href="17-2-logistic-17.html#cb643-9"></a>mods[[<span class="dv">5</span>]] &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>hatchery, <span class="dt">family =</span> binomial, <span class="dt">data =</span> choice)</span>
<span id="cb643-10"><a href="17-2-logistic-17.html#cb643-10"></a>mods[[<span class="dv">6</span>]] &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>flow, <span class="dt">family =</span> binomial, <span class="dt">data =</span> choice)</span>
<span id="cb643-11"><a href="17-2-logistic-17.html#cb643-11"></a>mods[[<span class="dv">7</span>]] &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(path <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>hatchery <span class="op">+</span><span class="st"> </span>flow, <span class="dt">family =</span> binomial, <span class="dt">data =</span> choice)</span></code></pre></div>
<p><strong>Next</strong>, give the models some names using the formulas for each of the models. <em>Remember</em>: models are stored as list objects in R, and each of those list objects (models) has names. We can reference those names using the <code>$</code> notation, and from there we can access the actual model <code>formula</code>. The third element of this <code>formula</code> object contains the explanatory variables!! Just like <code>glm()</code>. Whoa!</p>
<p>We can extract the <code>formula</code> for each model (which is an element in the <code>mods</code> list) using a <code>for</code> loop to assign them one at a time. Here, we are assigning the i<sup>th</sup> formula to be the name of the i<sup>th</sup> element in the list <code>mods</code>. Nifty. Note that this is pretty much identical to how we do this for models fit with <code>glm()</code>!</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="17-2-logistic-17.html#cb644-1"></a><span class="co"># Assign the formula for each of the models as the name</span></span>
<span id="cb644-2"><a href="17-2-logistic-17.html#cb644-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mods)) {</span>
<span id="cb644-3"><a href="17-2-logistic-17.html#cb644-3"></a>  <span class="kw">names</span>(mods)[i] &lt;-<span class="st"> </span><span class="kw">as.character</span>(mods[[i]]<span class="op">$</span>formula)[<span class="dv">3</span>]</span>
<span id="cb644-4"><a href="17-2-logistic-17.html#cb644-4"></a>}</span></code></pre></div>
<p>Now, we use the <code>loo</code> package to make a model selection table like we did in <a href="16-8-bayesian-model-selection.html#bayesian-model-selection">Chapter 16.8</a>:</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="17-2-logistic-17.html#cb645-1"></a><span class="co"># Load the library</span></span>
<span id="cb645-2"><a href="17-2-logistic-17.html#cb645-2"></a><span class="kw">library</span>(loo)</span>
<span id="cb645-3"><a href="17-2-logistic-17.html#cb645-3"></a></span>
<span id="cb645-4"><a href="17-2-logistic-17.html#cb645-4"></a><span class="co"># Extract the log-likelihood matrices</span></span>
<span id="cb645-5"><a href="17-2-logistic-17.html#cb645-5"></a>log_liks &lt;-<span class="st"> </span><span class="kw">lapply</span>(mods, log_lik)</span>
<span id="cb645-6"><a href="17-2-logistic-17.html#cb645-6"></a></span>
<span id="cb645-7"><a href="17-2-logistic-17.html#cb645-7"></a><span class="co"># Now apply the loo() function to each </span></span>
<span id="cb645-8"><a href="17-2-logistic-17.html#cb645-8"></a><span class="co"># model to get elpd_loo</span></span>
<span id="cb645-9"><a href="17-2-logistic-17.html#cb645-9"></a>loos &lt;-<span class="st"> </span><span class="kw">lapply</span>(log_liks, loo)</span>
<span id="cb645-10"><a href="17-2-logistic-17.html#cb645-10"></a></span>
<span id="cb645-11"><a href="17-2-logistic-17.html#cb645-11"></a><span class="co"># Finally, we can compare them with loo_compare()</span></span>
<span id="cb645-12"><a href="17-2-logistic-17.html#cb645-12"></a>mod_table &lt;-<span class="st"> </span><span class="kw">loo_compare</span>(loos)</span></code></pre></div>
<p>Nice.</p>
</div>
<div id="interpretting-17" class="section level3">
<h3><span class="header-section-number">17.2.3</span> Interpreting the results</h3>
<p>This proceeds the same way for GLM as it does for linear models until we get to making predictions of the response based on our best model.</p>
<p>Our model selection table is an object in R (<em>right</em>?), and we can reference that object using <code>$</code> notation, matrix notation <code>[ , ]</code>, or by calling <code>rownames()</code> to get the name for each of the models. Let’s use this approach to get the best model from our candidate set.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="17-2-logistic-17.html#cb646-1"></a><span class="co"># Print the table</span></span>
<span id="cb646-2"><a href="17-2-logistic-17.html#cb646-2"></a>mod_table</span></code></pre></div>
<pre><code>##                                 elpd_diff se_diff
## year + flow                      0.0       0.0   
## year + hatchery + flow          -0.1       1.4   
## year + length + flow            -0.5       1.2   
## year + hatchery + length + flow -1.0       1.5   
## year + hatchery                 -2.3       3.0   
## year + length                   -3.0       2.9   
## year + length + hatchery        -3.2       3.0</code></pre>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="17-2-logistic-17.html#cb648-1"></a><span class="co"># Look at the structure just to show that it is, indeed, an object:</span></span>
<span id="cb648-2"><a href="17-2-logistic-17.html#cb648-2"></a><span class="kw">str</span>(mod_table)</span></code></pre></div>
<pre><code>##  &#39;compare.loo&#39; num [1:7, 1:8] 0 -0.144 -0.534 -1.039 -2.324 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:7] &quot;year + flow&quot; &quot;year + hatchery + flow&quot; &quot;year + length + flow&quot; &quot;year + hatchery + length + flow&quot; ...
##   ..$ : chr [1:8] &quot;elpd_diff&quot; &quot;se_diff&quot; &quot;elpd_loo&quot; &quot;se_elpd_loo&quot; ...</code></pre>
<p>Look at the <code>rownames</code> of the table. These <code>rownames</code> are the index for each of our models as they appear in the <code>mods</code> object, and we can use the index to reference objects inside of the <code>mods</code> list…</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="17-2-logistic-17.html#cb650-1"></a><span class="kw">rownames</span>(mod_table)</span></code></pre></div>
<pre><code>## [1] &quot;year + flow&quot;                     &quot;year + hatchery + flow&quot;         
## [3] &quot;year + length + flow&quot;            &quot;year + hatchery + length + flow&quot;
## [5] &quot;year + hatchery&quot;                 &quot;year + length&quot;                  
## [7] &quot;year + length + hatchery&quot;</code></pre>
<p>The rowname for the best model (the one at the top of the table) is <code>year + flow</code>. Print the model to see it as follows. Notice the back-ticks (``) around the model name to deal with spaces.</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="17-2-logistic-17.html#cb652-1"></a><span class="kw">summary</span>( mods<span class="op">$</span><span class="st">`</span><span class="dt">year + flow</span><span class="st">`</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## 
## Model Info:
##  function:     stan_glm
##  family:       binomial [logit]
##  formula:      path ~ year + flow
##  algorithm:    sampling
##  sample:       4000 (posterior sample size)
##  priors:       see help(&#39;prior_summary&#39;)
##  observations: 759
##  predictors:   7
## 
## Estimates:
##               mean   sd     10%    50%    90% 
## (Intercept) -2.985  0.794 -4.016 -2.960 -2.003
## year2006    -0.500  0.618 -1.291 -0.504  0.295
## year2009     0.285  0.456 -0.292  0.276  0.870
## year2010    -0.004  0.642 -0.814 -0.020  0.821
## year2011    -0.790  0.407 -1.310 -0.781 -0.279
## year2012    -0.762  0.522 -1.443 -0.753 -0.090
## flow         0.002  0.001  0.001  0.002  0.002
## 
## Fit Diagnostics:
##            mean   sd    10%   50%   90%
## mean_PPD 0.128  0.016 0.108 0.128 0.149
## 
## The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help(&#39;summary.stanreg&#39;)).
## 
## MCMC diagnostics
##               mcse  Rhat  n_eff
## (Intercept)   0.023 1.003 1198 
## year2006      0.017 1.001 1383 
## year2009      0.013 1.002 1302 
## year2010      0.018 1.002 1223 
## year2011      0.010 1.000 1699 
## year2012      0.014 1.000 1454 
## flow          0.000 1.003 1523 
## mean_PPD      0.000 1.000 3569 
## log-posterior 0.050 1.003 1390 
## 
## For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
<p>Great! Let’s save this to an object so we can work with it a little easier.</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="17-2-logistic-17.html#cb654-1"></a>best_mod &lt;-<span class="st"> </span>mods<span class="op">$</span><span class="st">`</span><span class="dt">year + flow</span><span class="st">`</span></span></code></pre></div>
<p>We can get an understanding of the explanatory power of our model using a Bayesian R<sup>2</sup> (described by Gelman et al. <a href="10.1080/00031305.2018.1549100">2018</a>). By default, this function will return one estimate of the R<sup>2</sup> for each iteration of the model, so we should get 4,000 estimates of R<sup>2</sup> here.</p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="17-2-logistic-17.html#cb655-1"></a>r_squared &lt;-<span class="st"> </span><span class="kw">bayes_R2</span>(best_mod)</span>
<span id="cb655-2"><a href="17-2-logistic-17.html#cb655-2"></a></span>
<span id="cb655-3"><a href="17-2-logistic-17.html#cb655-3"></a><span class="kw">mean</span>(r_squared)</span></code></pre></div>
<pre><code>## [1] 0.050023</code></pre>
<p>Meh, about average for an ecological study, but that doesn’t mean it is good. What we are really after here is just a good idea of what proportion of fish use this route and whether it can be reasonably well related to discharge, so we’ll keep pressing along to see if we have that.</p>
<p>Let’s wrap our interpretation of results by looking at coefficient estimates as indicators of statistical significance.</p>
<p>First, we could extract just the parameters for ease:</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="17-2-logistic-17.html#cb657-1"></a>coeffs &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="kw">as.matrix</span>(best_mod) )</span></code></pre></div>
<p>The <code>coeffs</code> object is now a dataframe with 4,000 posterior samples (rows) of each model coefficient (columns).</p>
<p>Then, we can determine whether zero or any other value of interest is included within the credible range of values for each of these coefficients. If zero falls outside the credible range for any of the parameters, we can conclude that the effect was significant. For categorical variables, this means groups are different. For continuous explanatory variables, it means that the slope is different from zero (flat).</p>
<p>Pivot the coefficients into long form first so they are grouped for plotting, and then we’ll summarize the posteriors.</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="17-2-logistic-17.html#cb658-1"></a>coeffs_stacked &lt;-<span class="st"> </span>coeffs <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb658-2"><a href="17-2-logistic-17.html#cb658-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">everything</span>(),</span>
<span id="cb658-3"><a href="17-2-logistic-17.html#cb658-3"></a>               <span class="dt">names_to =</span> <span class="st">&quot;coeff&quot;</span>,</span>
<span id="cb658-4"><a href="17-2-logistic-17.html#cb658-4"></a>               <span class="dt">values_to =</span> <span class="st">&quot;val&quot;</span></span>
<span id="cb658-5"><a href="17-2-logistic-17.html#cb658-5"></a>               ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb658-6"><a href="17-2-logistic-17.html#cb658-6"></a><span class="st">  </span><span class="kw">group_by</span>(coeff)</span></code></pre></div>
<p>You can calculate means and 95% Credible intervals for plotting:</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="17-2-logistic-17.html#cb659-1"></a>post_summary &lt;-<span class="st"> </span>coeffs_stacked <span class="op">%&gt;%</span></span>
<span id="cb659-2"><a href="17-2-logistic-17.html#cb659-2"></a><span class="st">  </span><span class="kw">summarize</span>(</span>
<span id="cb659-3"><a href="17-2-logistic-17.html#cb659-3"></a>    <span class="dt">fit =</span> <span class="kw">mean</span>(val),</span>
<span id="cb659-4"><a href="17-2-logistic-17.html#cb659-4"></a>    <span class="dt">lwr =</span> <span class="kw">quantile</span>(val, <span class="fl">0.025</span>),</span>
<span id="cb659-5"><a href="17-2-logistic-17.html#cb659-5"></a>    <span class="dt">upr =</span> <span class="kw">quantile</span>(val, <span class="fl">0.975</span>)</span>
<span id="cb659-6"><a href="17-2-logistic-17.html#cb659-6"></a>  )</span></code></pre></div>
<p>We can plot these really easily to see whether any of the parameters overlap zero:</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="17-2-logistic-17.html#cb660-1"></a><span class="kw">ggplot</span>(post_summary, <span class="kw">aes</span>(<span class="dt">x =</span> coeff, <span class="dt">y =</span> fit, <span class="dt">color =</span> coeff, <span class="dt">fill =</span> coeff)) <span class="op">+</span></span>
<span id="cb660-2"><a href="17-2-logistic-17.html#cb660-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb660-3"><a href="17-2-logistic-17.html#cb660-3"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">xend =</span> coeff, <span class="dt">y =</span> lwr, <span class="dt">yend =</span> upr), <span class="dt">lwd=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-473-1.png" width="672" /></p>
<p>You can get a similar plot using the built-in <code>plot()</code> method for the fitted model object a lot more easily like so. By default, this method plots 95% high density (credible) intervals for each of the posteriors.</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="17-2-logistic-17.html#cb661-1"></a><span class="kw">plot</span>(best_mod)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-474-1.png" width="672" /></p>
<div id="categorical-17" class="section level4">
<h4><span class="header-section-number">17.2.3.1</span> Categorical effects</h4>
<p>Regardless of the method we use, we see there is a lot of variability between years and there is reasonable support to suggest that this variability is significant. How can we tell this? We don’t have access to p-values like we do in MLE or OLS anymore because of how the likelihood is expressed in these models. Instead, we can do group-wise comparisons to determine specific differences but this becomes cumbersome when we have many levels.</p>
<p>Remember, that the null hypothesis for factors under an ANOVA- or ANCOVA-like analysis is just that any two group means differ. In this case, it looks like 2011 and 2009 are the most different since 2011 has lower probability of using Stillwater Branch than 2005 (Intercept) and 2009 is greater.</p>
<p>If we want to compare year-specific means, we’ll need to make predictions on the logit scale and then convert to the real scale where we can actually derive the difference between years arithmetically for the entire posteriors.</p>
<p>Make predictions from the model on the logit scale, and convert to the real scale using the <code>invlogit()</code> function from the <code>rstanarm</code> package:</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="17-2-logistic-17.html#cb662-1"></a>p_stillwater_<span class="dv">2009</span> &lt;-<span class="st"> </span><span class="kw">invlogit</span>( </span>
<span id="cb662-2"><a href="17-2-logistic-17.html#cb662-2"></a>  coeffs<span class="op">$</span>X.Intercept. <span class="op">+</span><span class="st"> </span>coeffs<span class="op">$</span>year2009 <span class="op">+</span><span class="st"> </span>coeffs<span class="op">$</span>flow <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(choice<span class="op">$</span>flow))</span>
<span id="cb662-3"><a href="17-2-logistic-17.html#cb662-3"></a></span>
<span id="cb662-4"><a href="17-2-logistic-17.html#cb662-4"></a>p_stillwater_<span class="dv">2011</span> &lt;-<span class="st"> </span><span class="kw">invlogit</span>( </span>
<span id="cb662-5"><a href="17-2-logistic-17.html#cb662-5"></a>  coeffs<span class="op">$</span>X.Intercept. <span class="op">+</span><span class="st"> </span>coeffs<span class="op">$</span>year2011 <span class="op">+</span><span class="st"> </span>coeffs<span class="op">$</span>flow <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(choice<span class="op">$</span>flow))</span></code></pre></div>
<p>And now you can calculate the difference (note that this is for the average flow).</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="17-2-logistic-17.html#cb663-1"></a>difference &lt;-<span class="st"> </span>p_stillwater_<span class="dv">2009</span> <span class="op">-</span><span class="st"> </span>p_stillwater_<span class="dv">2011</span></span></code></pre></div>
<p>If we are interested in whether the true difference is equal to zero (null) then we can calculate quantiles:</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="17-2-logistic-17.html#cb664-1"></a><span class="kw">quantile</span>(difference, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.0329588 0.1875154</code></pre>
<p>In this case, there is at least a 95% chance that the probability of smolts using the Stillwater Branch varies between 2009 and 2011, so we can conclude that the effect is significant at <span class="math inline">\(\alpha\)</span> = 0.05.</p>
<p>We can also plot a histogram of the differences really easily now that it is just a vector in R:</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="17-2-logistic-17.html#cb666-1"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb666-2"><a href="17-2-logistic-17.html#cb666-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> difference), <span class="dt">binwidth =</span> <span class="fl">0.01</span>) <span class="op">+</span></span>
<span id="cb666-3"><a href="17-2-logistic-17.html#cb666-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Difference in p(Stillwater) between 2009 and 2011&quot;</span>) <span class="op">+</span></span>
<span id="cb666-4"><a href="17-2-logistic-17.html#cb666-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>) <span class="op">+</span></span>
<span id="cb666-5"><a href="17-2-logistic-17.html#cb666-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">450</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb666-6"><a href="17-2-logistic-17.html#cb666-6"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb666-7"><a href="17-2-logistic-17.html#cb666-7"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb666-8"><a href="17-2-logistic-17.html#cb666-8"></a>    <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">-1</span>),</span>
<span id="cb666-9"><a href="17-2-logistic-17.html#cb666-9"></a>    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">3</span>),</span>
<span id="cb666-10"><a href="17-2-logistic-17.html#cb666-10"></a>  )</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-478-1.png" width="672" /></p>
</div>
</div>
<div id="continuous-17" class="section level3">
<h3><span class="header-section-number">17.2.4</span> Continuous effects</h3>
<p>Interpreting significance and direction of continuous effects is a little more straightforward. In this case, we just need to determine whether the posterior estimate of the coefficient for continuous explanatory variables differs from zero or another value of interest.</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="17-2-logistic-17.html#cb667-1"></a><span class="kw">quantile</span>(coeffs<span class="op">$</span>flow, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##         2.5%        97.5% 
## 0.0005093474 0.0029282942</code></pre>
<p>It was really hard to see in the coefficients plot due to differences in scale, so we can make a histogram of this one to visualize that difference as well.</p>
</div>
<div id="predictions-17" class="section level3">
<h3><span class="header-section-number">17.2.5</span> Making predictions</h3>
<p>The first thing to remember here is that we have used a link function to estimate this model, so we cannot use the same method as we did for linear models to make predictions about our response from the model coefficients.</p>
<p>The second thing to remember here is that by definition we have used an <em>invertible</em> link function to estimate this model so the previous statement is a lie and we actually can use the same method as before to make predictions about our response from the model coefficients. We just need to add an extra step so that we can invert our predictions about the expected value of Y with respect to X.</p>
<p>Confused? Yeah, it’s a little confusing. As always an example always goes a long way…</p>
<p>We can make predictions from our best model pretty much the same way we did in <a href="https://danstich.github.io/worst-r/12-4-logistic.html#making-predictions">Chapter 12.4.4</a>.</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="17-2-logistic-17.html#cb669-1"></a><span class="co"># Make predictions from the best model</span></span>
<span id="cb669-2"><a href="17-2-logistic-17.html#cb669-2"></a>logit_preds &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="kw">predict</span>(best_mod, <span class="dt">type =</span> <span class="st">&quot;link&quot;</span>, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>) )</span>
<span id="cb669-3"><a href="17-2-logistic-17.html#cb669-3"></a></span>
<span id="cb669-4"><a href="17-2-logistic-17.html#cb669-4"></a><span class="co"># Calculate confidence intervals as 1.96 * standard error</span></span>
<span id="cb669-5"><a href="17-2-logistic-17.html#cb669-5"></a>logit_preds<span class="op">$</span>lwr &lt;-<span class="st"> </span>logit_preds<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>logit_preds<span class="op">$</span>se.fit</span>
<span id="cb669-6"><a href="17-2-logistic-17.html#cb669-6"></a>logit_preds<span class="op">$</span>upr &lt;-<span class="st"> </span>logit_preds<span class="op">$</span>fit <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>logit_preds<span class="op">$</span>se.fit</span>
<span id="cb669-7"><a href="17-2-logistic-17.html#cb669-7"></a></span>
<span id="cb669-8"><a href="17-2-logistic-17.html#cb669-8"></a><span class="co"># Invert the link function</span></span>
<span id="cb669-9"><a href="17-2-logistic-17.html#cb669-9"></a>real_preds &lt;-<span class="st"> </span><span class="kw">apply</span>(logit_preds, <span class="dv">2</span>, invlogit)</span>
<span id="cb669-10"><a href="17-2-logistic-17.html#cb669-10"></a></span>
<span id="cb669-11"><a href="17-2-logistic-17.html#cb669-11"></a><span class="co"># Combine the predictions with the original data</span></span>
<span id="cb669-12"><a href="17-2-logistic-17.html#cb669-12"></a>choice_preds &lt;-<span class="st"> </span><span class="kw">data.frame</span>(choice, real_preds)</span></code></pre></div>
<p>Go ahead and have a look at the <code>logit_preds</code> and <code>real_preds</code> objects to make sure you understand what we just did.</p>
<p>Now, we can finish by plotting our predictions:</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="17-2-logistic-17.html#cb670-1"></a><span class="kw">ggplot</span>(choice_preds, <span class="kw">aes</span>(<span class="dt">x =</span> flow, <span class="dt">y =</span> fit, <span class="dt">fill =</span> year)) <span class="op">+</span></span>
<span id="cb670-2"><a href="17-2-logistic-17.html#cb670-2"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lwr, <span class="dt">ymax =</span> upr, <span class="dt">fill =</span> year), <span class="dt">alpha =</span> <span class="fl">0.25</span>) <span class="op">+</span></span>
<span id="cb670-3"><a href="17-2-logistic-17.html#cb670-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> year)) <span class="op">+</span></span>
<span id="cb670-4"><a href="17-2-logistic-17.html#cb670-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Flow ( &quot;</span>, m<span class="op">^</span><span class="dv">3</span>, <span class="st">&quot;\u00b7&quot;</span>, s<span class="op">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></span>
<span id="cb670-5"><a href="17-2-logistic-17.html#cb670-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb670-6"><a href="17-2-logistic-17.html#cb670-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-481-1.png" width="672" />
<br></p>
<p>You can see that, in general, there is a relatively low probability of an individual fish using the Stillwater Branch, but we see increasing probability of using that route with increasing <code>flow</code> across years.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="17-1-intro17.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="17-3-next17.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["worstr.pdf", "worstr.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
