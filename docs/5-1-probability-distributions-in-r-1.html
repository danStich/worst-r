<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.1 Probability distributions in R | The Worst Stats Text eveR</title>
  <meta name="description" content="5.1 Probability distributions in R | The Worst Stats Text eveR" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="5.1 Probability distributions in R | The Worst Stats Text eveR" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.1 Probability distributions in R | The Worst Stats Text eveR" />
  
  
  

<meta name="author" content="Dan Stich" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="5-probability-distributions-in-r.html"/>
<link rel="next" href="5-2-calculating-sample-statistics-and-distributional-parameters-in-r.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Worst Stats Text eveR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>The Worst Stats Text eveR</a></li>
<li class="chapter" data-level="1" data-path="1-Chapter1.html"><a href="1-Chapter1.html"><i class="fa fa-check"></i><b>1</b> Introduction to programming in R</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-what-is-r.html"><a href="1-1-what-is-r.html"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="1-2-why-should-i-use-r.html"><a href="1-2-why-should-i-use-r.html"><i class="fa fa-check"></i><b>1.2</b> Why should I use R?</a></li>
<li class="chapter" data-level="1.3" data-path="1-3-where-do-i-start.html"><a href="1-3-where-do-i-start.html"><i class="fa fa-check"></i><b>1.3</b> Where do I start?</a></li>
<li class="chapter" data-level="1.4" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html"><i class="fa fa-check"></i><b>1.4</b> Programming conventions</a><ul>
<li class="chapter" data-level="" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html#style"><i class="fa fa-check"></i>Style and organization</a></li>
<li class="chapter" data-level="" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html#tips"><i class="fa fa-check"></i>Some handy coding tips</a></li>
<li class="chapter" data-level="" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html#rules"><i class="fa fa-check"></i>Stricter R programming rules</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1-5-next-steps.html"><a href="1-5-next-steps.html"><i class="fa fa-check"></i><b>1.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-Chapter2.html"><a href="2-Chapter2.html"><i class="fa fa-check"></i><b>2</b> Data structures</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-vectors.html"><a href="2-1-vectors.html"><i class="fa fa-check"></i><b>2.1</b> Vectors</a><ul>
<li class="chapter" data-level="" data-path="2-1-vectors.html"><a href="2-1-vectors.html#nums"><i class="fa fa-check"></i>Integers and numerics</a></li>
<li class="chapter" data-level="" data-path="2-1-vectors.html"><a href="2-1-vectors.html#strings"><i class="fa fa-check"></i>Characters and factors</a></li>
<li class="chapter" data-level="" data-path="2-1-vectors.html"><a href="2-1-vectors.html#logicals"><i class="fa fa-check"></i>Logical vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-2-operations.html"><a href="2-2-operations.html"><i class="fa fa-check"></i><b>2.2</b> Vector operations</a></li>
<li class="chapter" data-level="2.3" data-path="2-3-matrices.html"><a href="2-3-matrices.html"><i class="fa fa-check"></i><b>2.3</b> Matrices</a></li>
<li class="chapter" data-level="2.4" data-path="2-4-dataframes.html"><a href="2-4-dataframes.html"><i class="fa fa-check"></i><b>2.4</b> Dataframes</a></li>
<li class="chapter" data-level="2.5" data-path="2-5-lists.html"><a href="2-5-lists.html"><i class="fa fa-check"></i><b>2.5</b> Lists</a></li>
<li class="chapter" data-level="2.6" data-path="1-5-next-steps.html"><a href="1-5-next-steps.html#next-steps"><i class="fa fa-check"></i><b>2.6</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-Chapter3.html"><a href="3-Chapter3.html"><i class="fa fa-check"></i><b>3</b> Working with data</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-data-read.html"><a href="3-1-data-read.html"><i class="fa fa-check"></i><b>3.1</b> Data read</a></li>
<li class="chapter" data-level="3.2" data-path="3-2-quick-data-summaries.html"><a href="3-2-quick-data-summaries.html"><i class="fa fa-check"></i><b>3.2</b> Quick data summaries</a></li>
<li class="chapter" data-level="3.3" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html"><i class="fa fa-check"></i><b>3.3</b> Subsetting and selecting data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html#manual-subsets-and-selections"><i class="fa fa-check"></i><b>3.3.1</b> Manual subsets and selections</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html#subsetting-and-summaries-in-base-r"><i class="fa fa-check"></i><b>3.3.2</b> Subsetting and summaries in base R</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html#tidyverse"><i class="fa fa-check"></i><b>3.3.3</b> Subsetting and summaries in the tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-4-better-data-summaries.html"><a href="3-4-better-data-summaries.html"><i class="fa fa-check"></i><b>3.4</b> Better data summaries</a></li>
<li class="chapter" data-level="3.5" data-path="3-5-creating-new-variables.html"><a href="3-5-creating-new-variables.html"><i class="fa fa-check"></i><b>3.5</b> Creating new variables</a></li>
<li class="chapter" data-level="3.6" data-path="3-6-data-simulation.html"><a href="3-6-data-simulation.html"><i class="fa fa-check"></i><b>3.6</b> Data simulation</a><ul>
<li class="chapter" data-level="3.6.1" data-path="3-6-data-simulation.html"><a href="3-6-data-simulation.html#random-sub-samples-from-a-dataset"><i class="fa fa-check"></i><b>3.6.1</b> Random sub-samples from a dataset</a></li>
<li class="chapter" data-level="3.6.2" data-path="3-6-data-simulation.html"><a href="3-6-data-simulation.html#stochastic"><i class="fa fa-check"></i><b>3.6.2</b> Stochastic simulation</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="1-5-next-steps.html"><a href="1-5-next-steps.html#next-steps"><i class="fa fa-check"></i><b>3.7</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-Chapter4.html"><a href="4-Chapter4.html"><i class="fa fa-check"></i><b>4</b> Plotting and graphics</a><ul>
<li class="chapter" data-level="4.1" data-path="4-1-plots-matter-as-much-as-stats.html"><a href="4-1-plots-matter-as-much-as-stats.html"><i class="fa fa-check"></i><b>4.1</b> Plots matter as much as stats</a></li>
<li class="chapter" data-level="4.2" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html"><i class="fa fa-check"></i><b>4.2</b> Plotting with base R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#histograms"><i class="fa fa-check"></i><b>4.2.1</b> Histograms</a></li>
<li class="chapter" data-level="4.2.2" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#scatterplots"><i class="fa fa-check"></i><b>4.2.2</b> Scatterplots</a></li>
<li class="chapter" data-level="4.2.3" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#lines"><i class="fa fa-check"></i><b>4.2.3</b> Lines</a></li>
<li class="chapter" data-level="4.2.4" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#boxplots"><i class="fa fa-check"></i><b>4.2.4</b> Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>4.3</b> Plotting with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="4.3.1" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#gghists"><i class="fa fa-check"></i><b>4.3.1</b> Histograms</a></li>
<li class="chapter" data-level="4.3.2" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#ggscatter"><i class="fa fa-check"></i><b>4.3.2</b> Scatter plots</a></li>
<li class="chapter" data-level="4.3.3" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#gglines"><i class="fa fa-check"></i><b>4.3.3</b> Lines</a></li>
<li class="chapter" data-level="4.3.4" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#ggboxplots"><i class="fa fa-check"></i><b>4.3.4</b> Boxplots and violins</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="1-5-next-steps.html"><a href="1-5-next-steps.html#next-steps"><i class="fa fa-check"></i><b>4.4</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-probability-distributions-in-r.html"><a href="5-probability-distributions-in-r.html"><i class="fa fa-check"></i><b>5</b> Probability distributions in R</a><ul>
<li class="chapter" data-level="5.1" data-path="5-1-probability-distributions-in-r-1.html"><a href="5-1-probability-distributions-in-r-1.html"><i class="fa fa-check"></i><b>5.1</b> Probability distributions in R</a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-1-probability-distributions-in-r-1.html"><a href="5-1-probability-distributions-in-r-1.html#exponential-family-of-distributions"><i class="fa fa-check"></i><b>5.1.1</b> Exponential family of distributions</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-1-probability-distributions-in-r-1.html"><a href="5-1-probability-distributions-in-r-1.html#continuous-probability-distributions"><i class="fa fa-check"></i><b>5.1.2</b> Continuous probability distributions</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-1-probability-distributions-in-r-1.html"><a href="5-1-probability-distributions-in-r-1.html#discrete-probability-distributions"><i class="fa fa-check"></i><b>5.1.3</b> Discrete probability distributions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-2-calculating-sample-statistics-and-distributional-parameters-in-r.html"><a href="5-2-calculating-sample-statistics-and-distributional-parameters-in-r.html"><i class="fa fa-check"></i><b>5.2</b> Calculating sample statistics and distributional parameters in R</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-2-calculating-sample-statistics-and-distributional-parameters-in-r.html"><a href="5-2-calculating-sample-statistics-and-distributional-parameters-in-r.html#moments-about-the-mean"><i class="fa fa-check"></i><b>5.2.1</b> Moments about the mean</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-2-calculating-sample-statistics-and-distributional-parameters-in-r.html"><a href="5-2-calculating-sample-statistics-and-distributional-parameters-in-r.html#estimating-parameters-of-the-normal-distribution-from-a-sample"><i class="fa fa-check"></i><b>5.2.2</b> Estimating parameters of the normal distribution from a sample</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Worst Stats Text eveR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probability-distributions-in-r-1" class="section level2">
<h2><span class="header-section-number">5.1</span> Probability distributions in R</h2>
<p>R has a number of built-in distribution types, and there are random-number generators associated with most or all of these that will allow us to take random samples from a distribution (like picking numbers out of a hat!). This is useful for data simulation, but is also helpful for us to learn about probability distributions and how their parameters affect the shape, spread, scale, location, etc. of those distributions. We will briefly discuss concepts like skew because of how they can help us think about the assumptions that we are making (or breaking!) in the models that we use.</p>
<p>For this class, we will focus on one major family of distributions and then zero in on a few distributions within this family that you are guaranteed to encounter in analyses throughout your career.</p>
<div id="exponential-family-of-distributions" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Exponential family of distributions</h3>
<p>Most or all of the distributions we will need for this class come from the <strong>exponential family</strong> of distributions.</p>
<p>The exponential family is very flexible. It includes most of the probability distributions with which you are familiar, and many more. Just ask this <em>very</em> reliable <a href="https://en.wikipedia.org/wiki/Exponential_family">Wikipedia entry</a>. Oh, let’s face it, you were going there anyway, I just cut out the Google step.</p>
<p>Take a look at the table at the bottom of this Wikipedia page just to get an idea of how many distributions are included within the exponential! Holy cow! We’re not going to look at all of these in this class- I just want you to be aware that this is a <strong>huge</strong> family of specific distributions.</p>
<blockquote>
<p>Distributions that we’ll focus on this week:</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Continuous <br>
Normal (Gaussian) <br>
Lognormal <br>
Beta <br>
Uniform <br>
<br></li>
<li>Discrete distributions
Bernouli <br>
Binomial <br>
Multinomial <br>
Poisson <br>
Negative binomial <br></li>
</ol>
</div>
<div id="continuous-probability-distributions" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Continuous probability distributions</h3>
<blockquote>
<p>The normal distribution</p>
</blockquote>
<p>This is one distribution with which most of you have at least some nodding acquaintance.</p>
<p>The <strong>normal distribution</strong> is defined by two parameters:</p>
<ol style="list-style-type: decimal">
<li><p>The mean (<span class="math inline">\(\mu\)</span>)</p></li>
<li><p>The variance (<span class="math inline">\(\sigma^2\)</span>)</p></li>
</ol>
<p>Let’s take a look at what the normal distribution looks like. We’ll start with the standard normal (or <em>z</em>) distribution. The standard normal is a normal distribution with a mean of zero and a variance of 1.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="5-1-probability-distributions-in-r-1.html#cb1-1"></a><span class="co"># Plot a density curve as for 10k</span></span>
<span id="cb1-2"><a href="5-1-probability-distributions-in-r-1.html#cb1-2"></a><span class="co"># samples from a normal distribution</span></span>
<span id="cb1-3"><a href="5-1-probability-distributions-in-r-1.html#cb1-3"></a><span class="co"># as a thick, black line</span></span>
<span id="cb1-4"><a href="5-1-probability-distributions-in-r-1.html#cb1-4"></a><span class="kw">plot</span>(<span class="kw">density</span>(</span>
<span id="cb1-5"><a href="5-1-probability-distributions-in-r-1.html#cb1-5"></a>  <span class="kw">rnorm</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>)),</span>
<span id="cb1-6"><a href="5-1-probability-distributions-in-r-1.html#cb1-6"></a>  <span class="dt">main=</span><span class="st">&#39;&#39;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;black&#39;</span>,</span>
<span id="cb1-7"><a href="5-1-probability-distributions-in-r-1.html#cb1-7"></a>  <span class="dt">xlab=</span><span class="kw">expression</span>(theta), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>We can change the parameters of the standard normal to increase or decrease the degree of <strong>kurtosis</strong> or peakedness in our distribution. The blue line in the plot below shows a distribution with lower kurtosis than the z distribution (this one is called a <strong>t-distribution</strong>). The red line shows a distribution with greater kurtosis than the z distribution.</p>
<p>For line drawings like these, we can just add them to the existing plot to keep the same x and y scales and axes by using the <code>lines</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="5-1-probability-distributions-in-r-1.html#cb2-1"></a><span class="co"># Add thick, blue line to the</span></span>
<span id="cb2-2"><a href="5-1-probability-distributions-in-r-1.html#cb2-2"></a><span class="co"># plot for mu=0, sigma=2</span></span>
<span id="cb2-3"><a href="5-1-probability-distributions-in-r-1.html#cb2-3"></a><span class="kw">lines</span>(<span class="kw">density</span>(</span>
<span id="cb2-4"><a href="5-1-probability-distributions-in-r-1.html#cb2-4"></a>  <span class="kw">rnorm</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">2</span>)),</span>
<span id="cb2-5"><a href="5-1-probability-distributions-in-r-1.html#cb2-5"></a>  <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb2-6"><a href="5-1-probability-distributions-in-r-1.html#cb2-6"></a></span>
<span id="cb2-7"><a href="5-1-probability-distributions-in-r-1.html#cb2-7"></a><span class="co"># Add thick, red line to the</span></span>
<span id="cb2-8"><a href="5-1-probability-distributions-in-r-1.html#cb2-8"></a><span class="co"># plot for mu=0, sigma=0.5</span></span>
<span id="cb2-9"><a href="5-1-probability-distributions-in-r-1.html#cb2-9"></a><span class="kw">lines</span>(<span class="kw">density</span>(</span>
<span id="cb2-10"><a href="5-1-probability-distributions-in-r-1.html#cb2-10"></a>  <span class="kw">rnorm</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span>.<span class="dv">5</span>)),</span>
<span id="cb2-11"><a href="5-1-probability-distributions-in-r-1.html#cb2-11"></a>  <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)  </span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We can add a legend to clarify:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="5-1-probability-distributions-in-r-1.html#cb3-1"></a><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">1</span>,    <span class="co"># x-coordinate for legend</span></span>
<span id="cb3-2"><a href="5-1-probability-distributions-in-r-1.html#cb3-2"></a>       <span class="dt">y=</span>.<span class="dv">9</span>,   <span class="co"># Y-coordinate for legend</span></span>
<span id="cb3-3"><a href="5-1-probability-distributions-in-r-1.html#cb3-3"></a>       <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;mu=0, sd=1&#39;</span>, <span class="st">&#39;mu=0, sd=2&#39;</span>, <span class="st">&#39;mu=0, sd=.5&#39;</span>), <span class="co"># Names</span></span>
<span id="cb3-4"><a href="5-1-probability-distributions-in-r-1.html#cb3-4"></a>       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>), <span class="co"># Colors</span></span>
<span id="cb3-5"><a href="5-1-probability-distributions-in-r-1.html#cb3-5"></a>       <span class="dt">lty=</span><span class="dv">1</span>,  <span class="co"># Line type for legend symbols</span></span>
<span id="cb3-6"><a href="5-1-probability-distributions-in-r-1.html#cb3-6"></a>       <span class="dt">lwd=</span><span class="dv">2</span>,  <span class="co"># Line width for legend symbols</span></span>
<span id="cb3-7"><a href="5-1-probability-distributions-in-r-1.html#cb3-7"></a>       <span class="dt">bg=</span><span class="st">&#39;n&#39;</span>, <span class="co"># Legend fill: none</span></span>
<span id="cb3-8"><a href="5-1-probability-distributions-in-r-1.html#cb3-8"></a>       <span class="dt">bty=</span><span class="st">&#39;n&#39;</span> <span class="co"># Box type for legend: none</span></span>
<span id="cb3-9"><a href="5-1-probability-distributions-in-r-1.html#cb3-9"></a>) <span class="co"># Close call to legend</span></span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<blockquote>
<p>The lognormal distribution</p>
</blockquote>
<p>The <strong>lognormal distribution</strong> is a probability distribution that assumes our random variable is normally distributed on the <strong>log scale</strong>. This assumption allows us to incorporate <strong>skew</strong> into the normal distribution and change the location and spread of the normal distribution by transforming the parameters (<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>) onto the log scale. This is one of the more common data transformations that you will run into, e.g.: “We log-transformed the data to achieve normality…”</p>
<p>Let’s take a look at how changes to the mean change the location of this distribution:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="5-1-probability-distributions-in-r-1.html#cb4-1"></a><span class="co"># Plot the density fucntion for a lognormal</span></span>
<span id="cb4-2"><a href="5-1-probability-distributions-in-r-1.html#cb4-2"></a><span class="co"># distribution that has a mean of zero and</span></span>
<span id="cb4-3"><a href="5-1-probability-distributions-in-r-1.html#cb4-3"></a><span class="co"># a standard deviation of 1.</span></span>
<span id="cb4-4"><a href="5-1-probability-distributions-in-r-1.html#cb4-4"></a><span class="kw">plot</span>(<span class="kw">density</span>(</span>
<span id="cb4-5"><a href="5-1-probability-distributions-in-r-1.html#cb4-5"></a>  <span class="kw">rlnorm</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>)),</span>
<span id="cb4-6"><a href="5-1-probability-distributions-in-r-1.html#cb4-6"></a>  <span class="dt">main=</span><span class="st">&#39;&#39;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb4-7"><a href="5-1-probability-distributions-in-r-1.html#cb4-7"></a>  <span class="dt">xlab=</span><span class="kw">expression</span>(theta), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb4-8"><a href="5-1-probability-distributions-in-r-1.html#cb4-8"></a></span>
<span id="cb4-9"><a href="5-1-probability-distributions-in-r-1.html#cb4-9"></a><span class="co"># Now, we can change the parameters to change the location and spread</span></span>
<span id="cb4-10"><a href="5-1-probability-distributions-in-r-1.html#cb4-10"></a><span class="kw">lines</span>(<span class="kw">density</span>(</span>
<span id="cb4-11"><a href="5-1-probability-distributions-in-r-1.html#cb4-11"></a>  <span class="kw">rlnorm</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">mean=</span><span class="dv">1</span>, <span class="dt">sd=</span><span class="dv">1</span>)),</span>
<span id="cb4-12"><a href="5-1-probability-distributions-in-r-1.html#cb4-12"></a>  <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>) </span>
<span id="cb4-13"><a href="5-1-probability-distributions-in-r-1.html#cb4-13"></a></span>
<span id="cb4-14"><a href="5-1-probability-distributions-in-r-1.html#cb4-14"></a><span class="kw">lines</span>(<span class="kw">density</span>(</span>
<span id="cb4-15"><a href="5-1-probability-distributions-in-r-1.html#cb4-15"></a>  <span class="kw">rlnorm</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">mean=</span><span class="dv">2</span>, <span class="dt">sd=</span><span class="dv">1</span>)),</span>
<span id="cb4-16"><a href="5-1-probability-distributions-in-r-1.html#cb4-16"></a>  <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)  </span>
<span id="cb4-17"><a href="5-1-probability-distributions-in-r-1.html#cb4-17"></a></span>
<span id="cb4-18"><a href="5-1-probability-distributions-in-r-1.html#cb4-18"></a><span class="co"># Add a legend to the plot</span></span>
<span id="cb4-19"><a href="5-1-probability-distributions-in-r-1.html#cb4-19"></a><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">20</span>, <span class="dt">y=</span>.<span class="dv">9</span>,</span>
<span id="cb4-20"><a href="5-1-probability-distributions-in-r-1.html#cb4-20"></a>       <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;mu=0, sd=1&#39;</span>, <span class="st">&#39;mu=1, sd=1&#39;</span>, <span class="st">&#39;mu=2, sd=1&#39;</span>), </span>
<span id="cb4-21"><a href="5-1-probability-distributions-in-r-1.html#cb4-21"></a>       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>),</span>
<span id="cb4-22"><a href="5-1-probability-distributions-in-r-1.html#cb4-22"></a>       <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">bg=</span><span class="st">&#39;n&#39;</span>, <span class="dt">bty=</span><span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<blockquote>
<p>The beta distribution</p>
</blockquote>
<p>The <strong>beta distribution</strong> is a probability distribution that is constrained to the interval (0, 1). But, it is incredibly flexible in its parameterization, and as a result is very useful for stochastic simulation of variables on the probability scale, such as survival.</p>
<p>The parameters of the beta distribution are <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, or commonly <code>a</code> and <code>b</code> or <code>shape 1</code> and <code>shape 2</code>. Within this distribution, <span class="math inline">\(\alpha\)</span> pushes the distribution to the right (toward 1), and <span class="math inline">\(\beta\)</span> pushes the distribution to the left (toward 0). The relative magnitude of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> determine the location, shape, and spread of the probability distribution for our random variable. When <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are equal, and greater than 1, the beta distribution is a t-distribution within the interval (0, 1).</p>
<p>Let’s take a look:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="5-1-probability-distributions-in-r-1.html#cb5-1"></a><span class="co"># Within the rbeta function in R,</span></span>
<span id="cb5-2"><a href="5-1-probability-distributions-in-r-1.html#cb5-2"></a><span class="co"># &#39;a&#39; is called &#39;shape1&#39; and &#39;b&#39;</span></span>
<span id="cb5-3"><a href="5-1-probability-distributions-in-r-1.html#cb5-3"></a><span class="co"># is called &#39;shape2&#39;</span></span>
<span id="cb5-4"><a href="5-1-probability-distributions-in-r-1.html#cb5-4"></a><span class="kw">plot</span>(<span class="kw">density</span>(<span class="kw">rbeta</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">shape1=</span><span class="dv">50</span>, <span class="dt">shape2=</span><span class="dv">50</span>)),</span>
<span id="cb5-5"><a href="5-1-probability-distributions-in-r-1.html#cb5-5"></a>     <span class="dt">main=</span><span class="st">&#39;&#39;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;black&#39;</span>,</span>
<span id="cb5-6"><a href="5-1-probability-distributions-in-r-1.html#cb5-6"></a>     <span class="dt">xlab=</span><span class="kw">expression</span>(theta),</span>
<span id="cb5-7"><a href="5-1-probability-distributions-in-r-1.html#cb5-7"></a>     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb5-8"><a href="5-1-probability-distributions-in-r-1.html#cb5-8"></a></span>
<span id="cb5-9"><a href="5-1-probability-distributions-in-r-1.html#cb5-9"></a><span class="co"># Now, we can change the parameters</span></span>
<span id="cb5-10"><a href="5-1-probability-distributions-in-r-1.html#cb5-10"></a><span class="co"># to change the location and spread</span></span>
<span id="cb5-11"><a href="5-1-probability-distributions-in-r-1.html#cb5-11"></a><span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">rbeta</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">shape1=</span><span class="dv">50</span>, <span class="dt">shape2=</span><span class="dv">100</span>)), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>)      </span>
<span id="cb5-12"><a href="5-1-probability-distributions-in-r-1.html#cb5-12"></a><span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">rbeta</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">shape1=</span><span class="dv">500</span>, <span class="dt">shape2=</span><span class="dv">250</span>)), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)  </span>
<span id="cb5-13"><a href="5-1-probability-distributions-in-r-1.html#cb5-13"></a></span>
<span id="cb5-14"><a href="5-1-probability-distributions-in-r-1.html#cb5-14"></a><span class="co"># Add a legend to the plot</span></span>
<span id="cb5-15"><a href="5-1-probability-distributions-in-r-1.html#cb5-15"></a><span class="kw">legend</span>(<span class="dt">x=</span>.<span class="dv">65</span>, <span class="dt">y=</span><span class="dv">50</span>,</span>
<span id="cb5-16"><a href="5-1-probability-distributions-in-r-1.html#cb5-16"></a>       <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;a=50, b=50&#39;</span>, <span class="st">&#39;a=50, b=100&#39;</span>, <span class="st">&#39;a=500, b=250&#39;</span>), </span>
<span id="cb5-17"><a href="5-1-probability-distributions-in-r-1.html#cb5-17"></a>       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>),</span>
<span id="cb5-18"><a href="5-1-probability-distributions-in-r-1.html#cb5-18"></a>       <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">bg=</span><span class="st">&#39;n&#39;</span>, <span class="dt">bty=</span><span class="st">&#39;n&#39;</span>)      </span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="discrete-probability-distributions" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Discrete probability distributions</h3>
<p><strong>Discrete</strong> probability distributions are useful for situations in which our random variable of interest can only take specific values within the interval of interest. For example, this might include age, counts, pass/fail, or any number of conceivable categories. As a result, these require a slightly different treatment of probability as a discrete, rather than continuous phenomenon.</p>
<blockquote>
<p>The Bernoulli distribution</p>
</blockquote>
<p>The <strong>Bernoulli distribution</strong> is a special case of the binomial distribution with a single trial (see below for clarification). Bernoulli outcomes are those for which the random variable can take on one of two values: a one or a zero. This distribution is useful for visualizing processes such as coin flips, yes/no responses, live/dead endpoints, and a number of other very interesting phenomena. The Bernoulli distribution has a single parameter: the probability of success, but is also governed by sample size: n.</p>
<p>We can simulate data from a Bernoulli distribution in one of two ways in R</p>
<p>The “old-school” way of doing this was to draw from a binomial with a single <strong>trial</strong>. Here we randomly draw a single sample from a binomial with a single trial, and a probability of success of 50%. This can be likened to flipping a fair coin.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="5-1-probability-distributions-in-r-1.html#cb6-1"></a><span class="kw">rbinom</span>(<span class="dt">n=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span>.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>But now, there is a function in the <code>Rlab</code> package that simplifies this for the specific case of a Bernoulli.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="5-1-probability-distributions-in-r-1.html#cb8-1"></a><span class="co"># First, install the necessary package</span></span>
<span id="cb8-2"><a href="5-1-probability-distributions-in-r-1.html#cb8-2"></a><span class="co"># Uncomment to install</span></span>
<span id="cb8-3"><a href="5-1-probability-distributions-in-r-1.html#cb8-3"></a><span class="co"># install.packages(&#39;Rlab&#39;) </span></span>
<span id="cb8-4"><a href="5-1-probability-distributions-in-r-1.html#cb8-4"></a><span class="kw">library</span>(Rlab)</span></code></pre></div>
<pre><code>## Rlab 2.15.1 attached.</code></pre>
<pre><code>## 
## Attaching package: &#39;Rlab&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     dexp, dgamma, dweibull, pexp, pgamma, pweibull, qexp, qgamma,
##     qweibull, rexp, rgamma, rweibull</code></pre>
<pre><code>## The following object is masked from &#39;package:datasets&#39;:
## 
##     precip</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="5-1-probability-distributions-in-r-1.html#cb13-1"></a><span class="co"># Now we can take a random</span></span>
<span id="cb13-2"><a href="5-1-probability-distributions-in-r-1.html#cb13-2"></a><span class="co"># sample from a Bernoulli</span></span>
<span id="cb13-3"><a href="5-1-probability-distributions-in-r-1.html#cb13-3"></a></span>
<span id="cb13-4"><a href="5-1-probability-distributions-in-r-1.html#cb13-4"></a><span class="co"># Flip the coin once</span></span>
<span id="cb13-5"><a href="5-1-probability-distributions-in-r-1.html#cb13-5"></a><span class="kw">rbern</span>(<span class="dt">n=</span><span class="dv">1</span>, <span class="dt">prob=</span>.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="5-1-probability-distributions-in-r-1.html#cb15-1"></a><span class="co"># Flip the coin 10 times</span></span>
<span id="cb15-2"><a href="5-1-probability-distributions-in-r-1.html#cb15-2"></a><span class="kw">rbern</span>(<span class="dt">n=</span><span class="dv">10</span>, <span class="dt">prob=</span>.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##  [1] 0 1 1 0 0 1 1 0 1 1</code></pre>
<blockquote>
<p>The binomial distribution</p>
</blockquote>
<p>The <strong>binomial distribution</strong> is pretty similar to the Bernoulli distribution except that it also includes a parameter called <span class="math inline">\(N\)</span> (<code>size</code> in R) which corresponds to a number of trials. In most cases in biology, it will suffice to use the Bernoulli, but for modeling we will want to understand the binomial for things like random stratified designs and nested models that rely on the use of binomial distribution</p>
<p>To sample data from a binomial distribution, we can use <code>rbinom</code>. In this example we tell R that we want 10 samples (<code>n</code>) from a binomial distribution that has 10 trials (<code>size</code>) and a probability of success (<code>prob</code>) of 0.5. This is like having 10 people flip the coin 10 times instead of just one person flipping the coin 100 times.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="5-1-probability-distributions-in-r-1.html#cb17-1"></a><span class="co"># Take a random draw of 10 samples</span></span>
<span id="cb17-2"><a href="5-1-probability-distributions-in-r-1.html#cb17-2"></a><span class="co"># from a binomial distribution with 10 trials</span></span>
<span id="cb17-3"><a href="5-1-probability-distributions-in-r-1.html#cb17-3"></a><span class="co"># and probability of success equal to 0.50</span></span>
<span id="cb17-4"><a href="5-1-probability-distributions-in-r-1.html#cb17-4"></a><span class="kw">rbinom</span>(<span class="dt">n=</span><span class="dv">10</span>, <span class="dt">size=</span><span class="dv">10</span>, <span class="dt">prob=</span><span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 5 5 6 5 4 6 8 7 5 6</code></pre>
<blockquote>
<p>The multinomial distribution</p>
</blockquote>
<p>The <strong>multinomial distribution</strong> is a further generalization of the Binomial and Bernoulli distributions. Here, there are one or more possible categorical outcomes, and the probability of each one occuring is specified individually <strong>but all of them must sum to one</strong>. The categories are, in this case, assumed to be a <strong>mutually exclusive</strong> and <strong>exhaustive</strong> set of possible outcomes.</p>
<p>We can use the multinomial distribution to randomly sample from categories (imagine our response variable is a categorical variable, like the names of the students in this class). To do this:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="5-1-probability-distributions-in-r-1.html#cb19-1"></a><span class="co"># First, we make a vector of names:</span></span>
<span id="cb19-2"><a href="5-1-probability-distributions-in-r-1.html#cb19-2"></a>name &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Alex&#39;</span>, <span class="st">&#39;Eleanor&#39;</span>, <span class="st">&#39;Kathleen&#39;</span>, <span class="st">&#39;Madylin&#39;</span>)</span>
<span id="cb19-3"><a href="5-1-probability-distributions-in-r-1.html#cb19-3"></a></span>
<span id="cb19-4"><a href="5-1-probability-distributions-in-r-1.html#cb19-4"></a><span class="co"># Then, we assign a uniform probability of</span></span>
<span id="cb19-5"><a href="5-1-probability-distributions-in-r-1.html#cb19-5"></a><span class="co"># drawing any given name if they can all</span></span>
<span id="cb19-6"><a href="5-1-probability-distributions-in-r-1.html#cb19-6"></a><span class="co"># be drawn with equal frequency:</span></span>
<span id="cb19-7"><a href="5-1-probability-distributions-in-r-1.html#cb19-7"></a>probs &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">/</span><span class="kw">length</span>(name), <span class="dt">times=</span><span class="kw">length</span>(name))      </span>
<span id="cb19-8"><a href="5-1-probability-distributions-in-r-1.html#cb19-8"></a>probs      </span></code></pre></div>
<pre><code>## [1] 0.25 0.25 0.25 0.25</code></pre>
<p>Now, we can sample from a multinomial distribution using our objects. Here we are taking 5 samples from the distribution, each time we sample there is only one trial, and we are sampling the 4 probabilities above.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="5-1-probability-distributions-in-r-1.html#cb21-1"></a><span class="kw">rmultinom</span>(<span class="dt">n=</span><span class="dv">5</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span>probs)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    0    0    1    0    0
## [2,]    1    1    0    0    1
## [3,]    0    0    0    1    0
## [4,]    0    0    0    0    0</code></pre>
<p><strong>WHOA</strong> a matrix??!!! HOLY CRAP, WHAT DOES IT ALL MEAN?</p>
<p>Take a step back, breathe, and think about this. The rows in this matrix are you and your classmates. If we took one random sample from the multinomial distribution, it would look like this:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="5-1-probability-distributions-in-r-1.html#cb23-1"></a><span class="co"># Take a single sample from</span></span>
<span id="cb23-2"><a href="5-1-probability-distributions-in-r-1.html#cb23-2"></a><span class="co"># the list of student names    </span></span>
<span id="cb23-3"><a href="5-1-probability-distributions-in-r-1.html#cb23-3"></a><span class="kw">rmultinom</span>(<span class="dt">n=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span>probs)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    0
## [2,]    1
## [3,]    0
## [4,]    0</code></pre>
<p>Here, we pulled a single sample from the distribution, and probability of sampling a given individual was 0.25 (1/4). If it makes it easier, we can put your names next to it:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="5-1-probability-distributions-in-r-1.html#cb25-1"></a><span class="kw">cbind</span>(name, <span class="kw">rmultinom</span>(<span class="dt">n=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span>probs))</span></code></pre></div>
<pre><code>##      name          
## [1,] &quot;Alex&quot;     &quot;0&quot;
## [2,] &quot;Eleanor&quot;  &quot;1&quot;
## [3,] &quot;Kathleen&quot; &quot;0&quot;
## [4,] &quot;Madylin&quot;  &quot;0&quot;</code></pre>
<p>Now, if I was calling on you randomly in class, after 10 questions, the spread of people who have participated in class might look like this:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="5-1-probability-distributions-in-r-1.html#cb27-1"></a><span class="kw">cbind</span>(name, <span class="kw">rmultinom</span>(<span class="dt">n=</span><span class="dv">10</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span>probs))</span></code></pre></div>
<pre><code>##      name                                              
## [1,] &quot;Alex&quot;     &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;1&quot; &quot;1&quot; &quot;0&quot;
## [2,] &quot;Eleanor&quot;  &quot;1&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;1&quot;
## [3,] &quot;Kathleen&quot; &quot;0&quot; &quot;0&quot; &quot;1&quot; &quot;1&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot;
## [4,] &quot;Madylin&quot;  &quot;0&quot; &quot;1&quot; &quot;0&quot; &quot;0&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot;</code></pre>
<p>Taking this one step further, we could just draw a name and stop looking at these ugly (no but really they are <strong>awesome</strong>!) matrices:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="5-1-probability-distributions-in-r-1.html#cb29-1"></a>name[<span class="kw">which</span>(<span class="kw">rmultinom</span>(<span class="dt">n=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span>probs)<span class="op">&gt;</span><span class="dv">0</span>)]</span></code></pre></div>
<pre><code>## [1] &quot;Kathleen&quot;</code></pre>
<p>And now we have a way to randomly select an individual based on a multinomial distribution!</p>
<blockquote>
<p>The Poisson distribution</p>
</blockquote>
<p>The <strong>Poisson distribution</strong> is used for counts or other integer data. This distribution is widely used (and just as widely misused!) for its ability to account for a large number of biological and ecological processes in the models that we will discuss this semester. The Poisson distribution has a single parameter, <span class="math inline">\(\lambda\)</span>, which is both the mean and the variance of the distribution. So, despite its utility, the distribution is relatively inflexible with respect to shape and spread. <strong>Fun fact</strong>: this distribution was originally worked out by a French mathematician to predict the number of soldiers who were accidentally killed from being kicked by horses.</p>
<p>Take a look at how the distribution changes when you change <span class="math inline">\(\lambda\)</span>, and you will get an idea of how this one works.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="5-1-probability-distributions-in-r-1.html#cb31-1"></a><span class="kw">hist</span>(<span class="kw">rpois</span>(<span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">lambda=</span><span class="dv">100</span>), <span class="dt">main=</span><span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<blockquote>
<p>The negative binomial distribution</p>
</blockquote>
<p>Okay, this one can be a little difficult to wrap your head around but it’s an important one for us to know about. So, we will spend a little extra time setting this one up to try and be clear. Often, folks start out thinking that they’re going to use a Poisson distribution and they end up collecting with data that do not conform to the relative inflexibility of that single-parameter distribution. For the purpose of this class, we are not going to dive into the mechanics of the <strong>negative binomial distribution</strong>, but we do need to know what it looks like and why we might need it.</p>
<p>One useful way to conceptualize the negative binomial is to ask “how long does it take for some event to occur?” For example, we might ask how long it takes a fish to start migrating, how long it takes a sea turtle to recover in a rehabilitation center, how long it will take for a terminal patient to expire, or how frequently we see the expression of a gene of interest. These kinds of questions are asked in aptly named “time-to-event” models that rely on the variance structure of the negative binomial. In the context of these kinds of questions, the negative binomial is a discrete probability distribution (and not a continuous distribution) because the “time” component of the distribution is actually a series of independent Bernoulli trials (holy crap, I know!). For example: if we want to know how many days it will take for a turtle to recover, what we are really doing is asking on each day until recovery, “Is today the day?”. Then, we flip a coin and find out. So, each day in this example is a Bernoulli trial. Another way to think about this is the number of failures occurring in a sequence before a target number of sucesses is achieved.</p>
<p>For the classical parameterization:</p>
<p>We will start with looking at how many failures are observed before one success in a sequence of Bernoulli trials.</p>
<p>With probability of succes equal to 0.95, it doesn’t take long and most of the probability mass is on zero, with a couple of stragglers further out.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="5-1-probability-distributions-in-r-1.html#cb32-1"></a><span class="kw">hist</span>(<span class="kw">rnbinom</span>(<span class="fl">1e4</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span>.<span class="dv">95</span>))</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>If we decrease probability of success in each trial to 0.25, we see more failures on average before we reach success. Most of the time, it still takes less than 5 trials to reach a success, but some times it takes much longer.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="5-1-probability-distributions-in-r-1.html#cb33-1"></a><span class="kw">hist</span>(<span class="kw">rnbinom</span>(<span class="fl">1e4</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span>.<span class="dv">25</span>))</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>And, if we increase the number of successes that we use for our criterion, or target, then it spreads the distribution out even further.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="5-1-probability-distributions-in-r-1.html#cb34-1"></a><span class="kw">hist</span>(<span class="kw">rnbinom</span>(<span class="fl">1e4</span>, <span class="dt">size=</span><span class="dv">10</span>, <span class="dt">prob=</span>.<span class="dv">25</span>))        </span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Now, because of it’s properties, the negative binomial is also useful for number of other applications. Specifically, it has been widely used to represent Poisson-like processes in which the mean and variance are not equal (e.g., <strong>overdispersion</strong>). This has seen a lot of application in the field of ecology, especially for overdispersed count data.</p>
<p>Here, we draw 10,000 random samples from a distribution with a mean of 10 and an overdispersion parameter of 1. The overdispersion parameter is called ‘size’ because this is an alternative parameterization that is just making use of the relationships between existing parameters of the negative binomial. It’s easy to grasp how the mean changes the location of the distribution.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="5-1-probability-distributions-in-r-1.html#cb35-1"></a><span class="kw">hist</span>(<span class="kw">rnbinom</span>(<span class="fl">1e4</span>, <span class="dt">mu=</span><span class="dv">10</span>, <span class="dt">size=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>But, note how the overdispersion parameter changes things if you run the following code:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="5-1-probability-distributions-in-r-1.html#cb36-1"></a><span class="kw">hist</span>(<span class="kw">rnbinom</span>(<span class="fl">1e4</span>, <span class="dt">mu=</span><span class="dv">10</span>, <span class="dt">size=</span>.<span class="dv">1</span>))      </span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="5-1-probability-distributions-in-r-1.html#cb37-1"></a><span class="kw">hist</span>(<span class="kw">rnbinom</span>(<span class="fl">1e4</span>, <span class="dt">mu=</span><span class="dv">10</span>, <span class="dt">size=</span><span class="dv">10</span>))</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="5-1-probability-distributions-in-r-1.html#cb38-1"></a><span class="kw">hist</span>(<span class="kw">rnbinom</span>(<span class="fl">1e4</span>, <span class="dt">mu=</span><span class="dv">10</span>, <span class="dt">size=</span><span class="dv">100</span>))      </span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-22-3.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="5-1-probability-distributions-in-r-1.html#cb39-1"></a><span class="kw">hist</span>(<span class="kw">rnbinom</span>(<span class="fl">1e4</span>, <span class="dt">mu=</span><span class="dv">10</span>, <span class="dt">size=</span><span class="dv">1000</span>))  </span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-22-4.png" width="672" /></p>
<p>A more intuitive way to work with the negative binomial in R is by using
the <code>MASS</code> package. In this parameterization, we use the mean and the
dispersion parameter explicitly so it makes more sense:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="5-1-probability-distributions-in-r-1.html#cb40-1"></a><span class="co"># MASS comes pre-installed as part of base software</span></span>
<span id="cb40-2"><a href="5-1-probability-distributions-in-r-1.html#cb40-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb40-3"><a href="5-1-probability-distributions-in-r-1.html#cb40-3"></a><span class="kw">hist</span>(<span class="kw">rnegbin</span>(<span class="fl">1e4</span>, <span class="dt">mu=</span><span class="dv">10</span>, <span class="dt">theta =</span> <span class="fl">.1</span>))  </span>
<span id="cb40-4"><a href="5-1-probability-distributions-in-r-1.html#cb40-4"></a><span class="kw">hist</span>(<span class="kw">rnegbin</span>(<span class="fl">1e4</span>, <span class="dt">mu=</span><span class="dv">10</span>, <span class="dt">theta =</span> <span class="dv">10</span>))       </span>
<span id="cb40-5"><a href="5-1-probability-distributions-in-r-1.html#cb40-5"></a><span class="kw">hist</span>(<span class="kw">rnegbin</span>(<span class="fl">1e4</span>, <span class="dt">mu=</span><span class="dv">10</span>, <span class="dt">theta =</span> <span class="dv">100</span>))       </span>
<span id="cb40-6"><a href="5-1-probability-distributions-in-r-1.html#cb40-6"></a><span class="kw">hist</span>(<span class="kw">rnegbin</span>(<span class="fl">1e4</span>, <span class="dt">mu=</span><span class="dv">10</span>, <span class="dt">theta =</span> <span class="dv">1000</span>)) </span></code></pre></div>
<p><strong>NOTE</strong> that the results are pretty much identical.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="5-probability-distributions-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="5-2-calculating-sample-statistics-and-distributional-parameters-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["worstr.pdf", "worstr.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
