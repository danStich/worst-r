<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.3 Plotting with ggplot2 | The Worst Stats Text eveR</title>
  <meta name="description" content="4.3 Plotting with ggplot2 | The Worst Stats Text eveR" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="4.3 Plotting with ggplot2 | The Worst Stats Text eveR" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.3 Plotting with ggplot2 | The Worst Stats Text eveR" />
  
  
  

<meta name="author" content="Dan Stich" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="4-2-base-graphics.html"/>
<link rel="next" href="4-4-next4.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Worst Stats Text eveR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>The Worst Stats Text eveR</a></li>
<li class="chapter" data-level="1" data-path="1-Chapter1.html"><a href="1-Chapter1.html"><i class="fa fa-check"></i><b>1</b> Introduction to programming in R</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-what-is-r.html"><a href="1-1-what-is-r.html"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="1-2-why-should-i-use-r.html"><a href="1-2-why-should-i-use-r.html"><i class="fa fa-check"></i><b>1.2</b> Why should I use R?</a></li>
<li class="chapter" data-level="1.3" data-path="1-3-where-do-i-start.html"><a href="1-3-where-do-i-start.html"><i class="fa fa-check"></i><b>1.3</b> Where do I start?</a></li>
<li class="chapter" data-level="1.4" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html"><i class="fa fa-check"></i><b>1.4</b> Programming conventions</a><ul>
<li class="chapter" data-level="" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html#style"><i class="fa fa-check"></i>Style and organization</a></li>
<li class="chapter" data-level="" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html#tips"><i class="fa fa-check"></i>Some handy coding tips</a></li>
<li class="chapter" data-level="" data-path="1-4-programming-conventions.html"><a href="1-4-programming-conventions.html#rules"><i class="fa fa-check"></i>Stricter R programming rules</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1-5-next-steps.html"><a href="1-5-next-steps.html"><i class="fa fa-check"></i><b>1.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-Chapter2.html"><a href="2-Chapter2.html"><i class="fa fa-check"></i><b>2</b> Data structures</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-vectors.html"><a href="2-1-vectors.html"><i class="fa fa-check"></i><b>2.1</b> Vectors</a><ul>
<li class="chapter" data-level="" data-path="2-1-vectors.html"><a href="2-1-vectors.html#nums"><i class="fa fa-check"></i>Integers and numerics</a></li>
<li class="chapter" data-level="" data-path="2-1-vectors.html"><a href="2-1-vectors.html#strings"><i class="fa fa-check"></i>Characters and factors</a></li>
<li class="chapter" data-level="" data-path="2-1-vectors.html"><a href="2-1-vectors.html#logicals"><i class="fa fa-check"></i>Logical vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-2-operations.html"><a href="2-2-operations.html"><i class="fa fa-check"></i><b>2.2</b> Vector operations</a></li>
<li class="chapter" data-level="2.3" data-path="2-3-matrices.html"><a href="2-3-matrices.html"><i class="fa fa-check"></i><b>2.3</b> Matrices</a></li>
<li class="chapter" data-level="2.4" data-path="2-4-dataframes.html"><a href="2-4-dataframes.html"><i class="fa fa-check"></i><b>2.4</b> Dataframes</a></li>
<li class="chapter" data-level="2.5" data-path="2-5-lists.html"><a href="2-5-lists.html"><i class="fa fa-check"></i><b>2.5</b> Lists</a></li>
<li class="chapter" data-level="2.6" data-path="1-5-next-steps.html"><a href="1-5-next-steps.html#next-steps"><i class="fa fa-check"></i><b>2.6</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-Chapter3.html"><a href="3-Chapter3.html"><i class="fa fa-check"></i><b>3</b> Working with data</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-data-read.html"><a href="3-1-data-read.html"><i class="fa fa-check"></i><b>3.1</b> Data read</a></li>
<li class="chapter" data-level="3.2" data-path="3-2-quick-data-summaries.html"><a href="3-2-quick-data-summaries.html"><i class="fa fa-check"></i><b>3.2</b> Quick data summaries</a></li>
<li class="chapter" data-level="3.3" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html"><i class="fa fa-check"></i><b>3.3</b> Subsetting and selecting data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html#manual-subsets-and-selections"><i class="fa fa-check"></i><b>3.3.1</b> Manual subsets and selections</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html#subsetting-and-summaries-in-base-r"><i class="fa fa-check"></i><b>3.3.2</b> Subsetting and summaries in base R</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-3-subsetting-and-selecting-data.html"><a href="3-3-subsetting-and-selecting-data.html#tidyverse"><i class="fa fa-check"></i><b>3.3.3</b> Subsetting and summaries in the tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-4-better-data-summaries.html"><a href="3-4-better-data-summaries.html"><i class="fa fa-check"></i><b>3.4</b> Better data summaries</a></li>
<li class="chapter" data-level="3.5" data-path="3-5-creating-new-variables.html"><a href="3-5-creating-new-variables.html"><i class="fa fa-check"></i><b>3.5</b> Creating new variables</a></li>
<li class="chapter" data-level="3.6" data-path="3-6-data-simulation.html"><a href="3-6-data-simulation.html"><i class="fa fa-check"></i><b>3.6</b> Data simulation</a><ul>
<li class="chapter" data-level="3.6.1" data-path="3-6-data-simulation.html"><a href="3-6-data-simulation.html#random-sub-samples-from-a-dataset"><i class="fa fa-check"></i><b>3.6.1</b> Random sub-samples from a dataset</a></li>
<li class="chapter" data-level="3.6.2" data-path="3-6-data-simulation.html"><a href="3-6-data-simulation.html#stochastic"><i class="fa fa-check"></i><b>3.6.2</b> Stochastic simulation</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="1-5-next-steps.html"><a href="1-5-next-steps.html#next-steps"><i class="fa fa-check"></i><b>3.7</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-Chapter4.html"><a href="4-Chapter4.html"><i class="fa fa-check"></i><b>4</b> Plotting and graphics</a><ul>
<li class="chapter" data-level="4.1" data-path="4-1-plots-matter-as-much-as-stats.html"><a href="4-1-plots-matter-as-much-as-stats.html"><i class="fa fa-check"></i><b>4.1</b> Plots matter as much as stats</a></li>
<li class="chapter" data-level="4.2" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html"><i class="fa fa-check"></i><b>4.2</b> Plotting with base R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#histograms"><i class="fa fa-check"></i><b>4.2.1</b> Histograms</a></li>
<li class="chapter" data-level="4.2.2" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#scatterplots"><i class="fa fa-check"></i><b>4.2.2</b> Scatterplots</a></li>
<li class="chapter" data-level="4.2.3" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#lines"><i class="fa fa-check"></i><b>4.2.3</b> Lines</a></li>
<li class="chapter" data-level="4.2.4" data-path="4-2-base-graphics.html"><a href="4-2-base-graphics.html#boxplots"><i class="fa fa-check"></i><b>4.2.4</b> Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>4.3</b> Plotting with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="4.3.1" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#gghists"><i class="fa fa-check"></i><b>4.3.1</b> Histograms</a></li>
<li class="chapter" data-level="4.3.2" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#ggscatter"><i class="fa fa-check"></i><b>4.3.2</b> Scatter plots</a></li>
<li class="chapter" data-level="4.3.3" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#gglines"><i class="fa fa-check"></i><b>4.3.3</b> Lines</a></li>
<li class="chapter" data-level="4.3.4" data-path="4-3-plotting-with-ggplot2.html"><a href="4-3-plotting-with-ggplot2.html#ggboxplots"><i class="fa fa-check"></i><b>4.3.4</b> Boxplots and</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4-4-next4.html"><a href="4-4-next4.html"><i class="fa fa-check"></i><b>4.4</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-sampling-distributions-in-r.html"><a href="5-sampling-distributions-in-r.html"><i class="fa fa-check"></i><b>5</b> Sampling distributions in R</a><ul>
<li class="chapter" data-level="5.1" data-path="5-1-what-are-sampling-distributions.html"><a href="5-1-what-are-sampling-distributions.html"><i class="fa fa-check"></i><b>5.1</b> What are sampling distributions?</a></li>
<li class="chapter" data-level="5.2" data-path="5-2-probability-distributions-in-r.html"><a href="5-2-probability-distributions-in-r.html"><i class="fa fa-check"></i><b>5.2</b> Probability distributions in R</a></li>
<li class="chapter" data-level="5.3" data-path="5-3-exponential-family.html"><a href="5-3-exponential-family.html"><i class="fa fa-check"></i><b>5.3</b> Exponential family</a></li>
<li class="chapter" data-level="5.4" data-path="5-4-continuous-distributions.html"><a href="5-4-continuous-distributions.html"><i class="fa fa-check"></i><b>5.4</b> Continuous distributions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="5-4-continuous-distributions.html"><a href="5-4-continuous-distributions.html#the-lognormal-distribution"><i class="fa fa-check"></i><b>5.4.1</b> The lognormal distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="5-4-continuous-distributions.html"><a href="5-4-continuous-distributions.html#the-beta-distribution"><i class="fa fa-check"></i><b>5.4.2</b> The beta distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html"><i class="fa fa-check"></i><b>5.5</b> Discrete distributions</a><ul>
<li class="chapter" data-level="5.5.1" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#bernoulli"><i class="fa fa-check"></i><b>5.5.1</b> Bernoulli</a></li>
<li class="chapter" data-level="5.5.2" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#binomial"><i class="fa fa-check"></i><b>5.5.2</b> Binomial</a></li>
<li class="chapter" data-level="5.5.3" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#multinomial"><i class="fa fa-check"></i><b>5.5.3</b> Multinomial</a></li>
<li class="chapter" data-level="5.5.4" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#poisson"><i class="fa fa-check"></i><b>5.5.4</b> Poisson</a></li>
<li class="chapter" data-level="5.5.5" data-path="5-5-discrete-distributions.html"><a href="5-5-discrete-distributions.html#the-negative-binomial-distribution"><i class="fa fa-check"></i><b>5.5.5</b> The negative binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="5-6-sample-statistics.html"><a href="5-6-sample-statistics.html"><i class="fa fa-check"></i><b>5.6</b> Sample statistics</a><ul>
<li class="chapter" data-level="5.6.1" data-path="5-6-sample-statistics.html"><a href="5-6-sample-statistics.html#moments-about-the-mean"><i class="fa fa-check"></i><b>5.6.1</b> Moments about the mean</a></li>
<li class="chapter" data-level="5.6.2" data-path="5-6-sample-statistics.html"><a href="5-6-sample-statistics.html#estimating-parameters-of-the-normal-distribution-from-a-sample"><i class="fa fa-check"></i><b>5.6.2</b> Estimating parameters of the normal distribution from a sample</a></li>
<li class="chapter" data-level="5.6.3" data-path="5-6-sample-statistics.html"><a href="5-6-sample-statistics.html#quantiles-and-other-descriptive-statistics"><i class="fa fa-check"></i><b>5.6.3</b> Quantiles and other descriptive statistics</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="5-7-next5.html"><a href="5-7-next5.html"><i class="fa fa-check"></i><b>5.7</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Worst Stats Text eveR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-with-ggplot2" class="section level2">
<h2><span class="header-section-number">4.3</span> Plotting with <code>ggplot2</code></h2>
<p>Plotting with <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a> and the dozens of packages that use it is a bit different than plotting with base graphics in R. Part of the reason for this is that it uses a work flow that is similar to the data manipulation we have looked at so far. In general, you could think of this as creating a canvas, applying some routine aesthetics based on the data structure (e.g. grouping), and then adding layers on to the canvas like we did with <a href="4-2-base-graphics.html#base-graphics">base graphics</a>.</p>
<p>It takes a little getting used to, but you’ll see how powerful it can be for multifaceted plots when we get to later chapters. We’ll walk through the same plots that we did in <a href="4-2-base-graphics.html#base-graphics">base graphics</a>, but this time we’ll use the <code>ggplot()</code> function and layer on the pieces.</p>
<div id="gghists" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Histograms</h3>
<p>The default histogram is easy to create with <code>ggplot()</code> and a geometry layer. We start with the <code>ggplot</code> call, and then add the histogram geometry, <code>geom_histogram()</code>, like this. I usually save the plot to an object with an arbitrary name I don’t use for anything, like <code>p</code> or <code>s</code> or <code>v</code>, and then print it explicitly.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="4-3-plotting-with-ggplot2.html#cb15-1"></a><span class="co"># Histogram of water temperature across </span></span>
<span id="cb15-2"><a href="4-3-plotting-with-ggplot2.html#cb15-2"></a><span class="co"># all dates and depths</span></span>
<span id="cb15-3"><a href="4-3-plotting-with-ggplot2.html#cb15-3"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(otsego, <span class="kw">aes</span>(<span class="dt">x=</span>temp)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">30</span>)</span>
<span id="cb15-4"><a href="4-3-plotting-with-ggplot2.html#cb15-4"></a></span>
<span id="cb15-5"><a href="4-3-plotting-with-ggplot2.html#cb15-5"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Right away this looks a lot prettier than the default histogram that we produced with base graphics. Of course, we can customize just like we did before.</p>
<p>Let’s add labels for the x and y-axis next:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="4-3-plotting-with-ggplot2.html#cb16-1"></a><span class="co"># Histogram of water temperature across </span></span>
<span id="cb16-2"><a href="4-3-plotting-with-ggplot2.html#cb16-2"></a><span class="co"># all dates and depths</span></span>
<span id="cb16-3"><a href="4-3-plotting-with-ggplot2.html#cb16-3"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(otsego, <span class="kw">aes</span>(<span class="dt">x=</span>temp)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-4"><a href="4-3-plotting-with-ggplot2.html#cb16-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">30</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-5"><a href="4-3-plotting-with-ggplot2.html#cb16-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Temperature (&quot;</span>, degree, <span class="st">&quot;C)&quot;</span>))) <span class="op">+</span></span>
<span id="cb16-6"><a href="4-3-plotting-with-ggplot2.html#cb16-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>)</span>
<span id="cb16-7"><a href="4-3-plotting-with-ggplot2.html#cb16-7"></a></span>
<span id="cb16-8"><a href="4-3-plotting-with-ggplot2.html#cb16-8"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>We can also scale the <code>x-axis</code> and the <code>y-axis</code> like we did in the base graphics example {#histograms}.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="4-3-plotting-with-ggplot2.html#cb17-1"></a><span class="co"># Histogram of water temperature across </span></span>
<span id="cb17-2"><a href="4-3-plotting-with-ggplot2.html#cb17-2"></a><span class="co"># all dates and depths</span></span>
<span id="cb17-3"><a href="4-3-plotting-with-ggplot2.html#cb17-3"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(otsego, <span class="kw">aes</span>(<span class="dt">x=</span>temp)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-4"><a href="4-3-plotting-with-ggplot2.html#cb17-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">30</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-5"><a href="4-3-plotting-with-ggplot2.html#cb17-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Temperature (&quot;</span>, degree, <span class="st">&quot;C)&quot;</span>))) <span class="op">+</span></span>
<span id="cb17-6"><a href="4-3-plotting-with-ggplot2.html#cb17-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>) <span class="op">+</span></span>
<span id="cb17-7"><a href="4-3-plotting-with-ggplot2.html#cb17-7"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-8"><a href="4-3-plotting-with-ggplot2.html#cb17-8"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb17-9"><a href="4-3-plotting-with-ggplot2.html#cb17-9"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>We can modify each of other layers individually, all at once using preset ggplot <a href="http://www.sthda.com/english/wiki/ggplot2-title-main-axis-and-legend-titles">themes</a> or by modifying a pre-defined theme.</p>
<p>Let’s have a look at how a theme changes the appearance. I am going to add <code>theme_bw()</code> here, but check out the others linked above. I also add a few adjust the position of the x- and y-axis labels and removed the panel grid in the <code>theme()</code> function after applying a theme.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="4-3-plotting-with-ggplot2.html#cb18-1"></a><span class="co"># Histogram of water temperature across </span></span>
<span id="cb18-2"><a href="4-3-plotting-with-ggplot2.html#cb18-2"></a><span class="co"># all dates and depths</span></span>
<span id="cb18-3"><a href="4-3-plotting-with-ggplot2.html#cb18-3"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(otsego, <span class="kw">aes</span>(<span class="dt">x=</span>temp)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-4"><a href="4-3-plotting-with-ggplot2.html#cb18-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">30</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-5"><a href="4-3-plotting-with-ggplot2.html#cb18-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-6"><a href="4-3-plotting-with-ggplot2.html#cb18-6"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-7"><a href="4-3-plotting-with-ggplot2.html#cb18-7"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Temperature (&quot;</span>, degree, <span class="st">&quot;C)&quot;</span>))) <span class="op">+</span></span>
<span id="cb18-8"><a href="4-3-plotting-with-ggplot2.html#cb18-8"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>) <span class="op">+</span></span>
<span id="cb18-9"><a href="4-3-plotting-with-ggplot2.html#cb18-9"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb18-10"><a href="4-3-plotting-with-ggplot2.html#cb18-10"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb18-11"><a href="4-3-plotting-with-ggplot2.html#cb18-11"></a>    <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">-1</span>),</span>
<span id="cb18-12"><a href="4-3-plotting-with-ggplot2.html#cb18-12"></a>    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">3</span>),</span>
<span id="cb18-13"><a href="4-3-plotting-with-ggplot2.html#cb18-13"></a>    <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()</span>
<span id="cb18-14"><a href="4-3-plotting-with-ggplot2.html#cb18-14"></a>  )</span>
<span id="cb18-15"><a href="4-3-plotting-with-ggplot2.html#cb18-15"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Spend some time practicing this and changing options to see what you can come up with. Be sure to check out the descriptions of the options you can pass to theme by running <code>?theme</code> to get the help file.</p>
</div>
<div id="ggscatter" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Scatter plots</h3>
<p>Now that we have a basic feel for the <code>ggplot2</code> work flow, changing plot types is really easy because all of the parts of our plots work together in the same way.</p>
<p>As a reminder, we previously built scatter plots of surface temperature in Otsego Lake, NY by month using base graphics.</p>
<p>Go ahead and subset the data again:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="4-3-plotting-with-ggplot2.html#cb19-1"></a>surface &lt;-<span class="st"> </span>otsego <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(depth <span class="op">==</span><span class="st"> </span><span class="fl">0.10</span>)</span></code></pre></div>
<p>Now, we can make the default scatterplot:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="4-3-plotting-with-ggplot2.html#cb20-1"></a>s &lt;-<span class="st"> </span><span class="kw">ggplot</span>(surface, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> temp)) <span class="op">+</span></span>
<span id="cb20-2"><a href="4-3-plotting-with-ggplot2.html#cb20-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span>
<span id="cb20-3"><a href="4-3-plotting-with-ggplot2.html#cb20-3"></a><span class="kw">print</span>(s)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>At a glance, this already looks a lot nicer than the default scatterplots from base graphics, but we still have a lot of work to do. Plus, we get ggplots own odd behaviors when it comes to the x-axis scale and titles. So, let’s get to work!</p>
<p>First, we’ll replace the default axis titles and add the <code>theme_bw()</code> that we used above, with the same modifications to axis positions and grid lines.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="4-3-plotting-with-ggplot2.html#cb21-1"></a>s &lt;-<span class="st"> </span><span class="kw">ggplot</span>(surface, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> temp)) <span class="op">+</span></span>
<span id="cb21-2"><a href="4-3-plotting-with-ggplot2.html#cb21-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-3"><a href="4-3-plotting-with-ggplot2.html#cb21-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="op">+</span></span>
<span id="cb21-4"><a href="4-3-plotting-with-ggplot2.html#cb21-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Temperature ( &quot;</span>, degree, <span class="st">&quot;C)&quot;</span>))) <span class="op">+</span></span>
<span id="cb21-5"><a href="4-3-plotting-with-ggplot2.html#cb21-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb21-6"><a href="4-3-plotting-with-ggplot2.html#cb21-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">-1</span>),</span>
<span id="cb21-7"><a href="4-3-plotting-with-ggplot2.html#cb21-7"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">3</span>),</span>
<span id="cb21-8"><a href="4-3-plotting-with-ggplot2.html#cb21-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()</span>
<span id="cb21-9"><a href="4-3-plotting-with-ggplot2.html#cb21-9"></a>  )</span>
<span id="cb21-10"><a href="4-3-plotting-with-ggplot2.html#cb21-10"></a><span class="kw">print</span>(s)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Okay, now we need to fix that pesky x-axis scale to use whole months or text labels.</p>
<p>To fix the axis scales, we’ve actually got to do a little bit of work this time. In this case the easiest thing to do is probably to make a categorical variable out of the column <code>month</code>, which is an integer. We can do this using some fancy indexing with the built-in object that contains month abbreviations, <code>month.abb</code> in base R.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="4-3-plotting-with-ggplot2.html#cb22-1"></a>surface<span class="op">$</span>c_month &lt;-<span class="st"> </span><span class="kw">factor</span>(month.abb[surface<span class="op">$</span>month], <span class="dt">levels=</span>month.abb)</span></code></pre></div>
<p>Whoa, that was a heavy lift (sarcasm). Let’s see how that changes the appearance of our plot:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="4-3-plotting-with-ggplot2.html#cb23-1"></a>s &lt;-<span class="st"> </span><span class="kw">ggplot</span>(surface, <span class="kw">aes</span>(<span class="dt">x =</span> c_month, <span class="dt">y =</span> temp)) <span class="op">+</span></span>
<span id="cb23-2"><a href="4-3-plotting-with-ggplot2.html#cb23-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-3"><a href="4-3-plotting-with-ggplot2.html#cb23-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="op">+</span></span>
<span id="cb23-4"><a href="4-3-plotting-with-ggplot2.html#cb23-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Temperature ( &quot;</span>, degree, <span class="st">&quot;C)&quot;</span>))) <span class="op">+</span></span>
<span id="cb23-5"><a href="4-3-plotting-with-ggplot2.html#cb23-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb23-6"><a href="4-3-plotting-with-ggplot2.html#cb23-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">-1</span>),</span>
<span id="cb23-7"><a href="4-3-plotting-with-ggplot2.html#cb23-7"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">3</span>),</span>
<span id="cb23-8"><a href="4-3-plotting-with-ggplot2.html#cb23-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()</span>
<span id="cb23-9"><a href="4-3-plotting-with-ggplot2.html#cb23-9"></a>  )</span>
<span id="cb23-10"><a href="4-3-plotting-with-ggplot2.html#cb23-10"></a><span class="kw">print</span>(s)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-24-1.png" width="672" />
This is starting to look really nice.</p>
<p>Finally, we just add a little transparency to the points by specifying <code>alpha = 0.2</code> inside of <code>geom_point()</code> and we are good to go!</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="4-3-plotting-with-ggplot2.html#cb24-1"></a>s &lt;-<span class="st"> </span><span class="kw">ggplot</span>(surface, <span class="kw">aes</span>(<span class="dt">x =</span> c_month, <span class="dt">y =</span> temp)) <span class="op">+</span></span>
<span id="cb24-2"><a href="4-3-plotting-with-ggplot2.html#cb24-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-3"><a href="4-3-plotting-with-ggplot2.html#cb24-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="op">+</span></span>
<span id="cb24-4"><a href="4-3-plotting-with-ggplot2.html#cb24-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Temperature ( &quot;</span>, degree, <span class="st">&quot;C)&quot;</span>))) <span class="op">+</span></span>
<span id="cb24-5"><a href="4-3-plotting-with-ggplot2.html#cb24-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb24-6"><a href="4-3-plotting-with-ggplot2.html#cb24-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">-1</span>),</span>
<span id="cb24-7"><a href="4-3-plotting-with-ggplot2.html#cb24-7"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">3</span>),</span>
<span id="cb24-8"><a href="4-3-plotting-with-ggplot2.html#cb24-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()</span>
<span id="cb24-9"><a href="4-3-plotting-with-ggplot2.html#cb24-9"></a>  )</span>
<span id="cb24-10"><a href="4-3-plotting-with-ggplot2.html#cb24-10"></a><span class="kw">print</span>(s)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Looks just like the one we made with base graphics!</p>
</div>
<div id="gglines" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Lines</h3>
<p>Most of the time we plot line graphs, whether in base graphics or using <code>ggplot2</code>, we are going to be adding them to existing plots. This was really straightforward in base graphics. It is only slightly more complicated in <code>ggplot2</code>.</p>
<p>We’ll start with the default line graph, and then add it to the scatter plot from the previous section.</p>
<p>Let’s calculate monthly means of surface temperature in Otsego Lake again:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="4-3-plotting-with-ggplot2.html#cb25-1"></a>mids &lt;-<span class="st"> </span>surface <span class="op">%&gt;%</span></span>
<span id="cb25-2"><a href="4-3-plotting-with-ggplot2.html#cb25-2"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb25-3"><a href="4-3-plotting-with-ggplot2.html#cb25-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">avg =</span> <span class="kw">mean</span>(temp))</span></code></pre></div>
<p>Now plot it with <code>ggplot()</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="4-3-plotting-with-ggplot2.html#cb26-1"></a>lp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mids, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> avg)) <span class="op">+</span></span>
<span id="cb26-2"><a href="4-3-plotting-with-ggplot2.html#cb26-2"></a><span class="st">  </span><span class="kw">geom_line</span>()</span>
<span id="cb26-3"><a href="4-3-plotting-with-ggplot2.html#cb26-3"></a></span>
<span id="cb26-4"><a href="4-3-plotting-with-ggplot2.html#cb26-4"></a><span class="kw">print</span>(lp)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>There you have it!</p>
<p>Now, we just need to add this to our scatterplot that we made previously. To do this, we have to insert <code>geom_line()</code> in the code, but we must specify</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="4-3-plotting-with-ggplot2.html#cb27-1"></a>s &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> surface, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> c_month, <span class="dt">y =</span> temp)) <span class="op">+</span></span>
<span id="cb27-2"><a href="4-3-plotting-with-ggplot2.html#cb27-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.20</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb27-3"><a href="4-3-plotting-with-ggplot2.html#cb27-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> avg),</span>
<span id="cb27-4"><a href="4-3-plotting-with-ggplot2.html#cb27-4"></a>            <span class="dt">data =</span> mids,</span>
<span id="cb27-5"><a href="4-3-plotting-with-ggplot2.html#cb27-5"></a>            <span class="dt">color =</span> <span class="st">&#39;gray40&#39;</span>,</span>
<span id="cb27-6"><a href="4-3-plotting-with-ggplot2.html#cb27-6"></a>            <span class="dt">lty =</span> <span class="dv">3</span>,</span>
<span id="cb27-7"><a href="4-3-plotting-with-ggplot2.html#cb27-7"></a>            <span class="dt">lwd =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb27-8"><a href="4-3-plotting-with-ggplot2.html#cb27-8"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="op">+</span></span>
<span id="cb27-9"><a href="4-3-plotting-with-ggplot2.html#cb27-9"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Temperature ( &quot;</span>, degree, <span class="st">&quot;C)&quot;</span>))) <span class="op">+</span></span>
<span id="cb27-10"><a href="4-3-plotting-with-ggplot2.html#cb27-10"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb27-11"><a href="4-3-plotting-with-ggplot2.html#cb27-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">-1</span>),</span>
<span id="cb27-12"><a href="4-3-plotting-with-ggplot2.html#cb27-12"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">3</span>),</span>
<span id="cb27-13"><a href="4-3-plotting-with-ggplot2.html#cb27-13"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()</span>
<span id="cb27-14"><a href="4-3-plotting-with-ggplot2.html#cb27-14"></a>  )</span>
<span id="cb27-15"><a href="4-3-plotting-with-ggplot2.html#cb27-15"></a></span>
<span id="cb27-16"><a href="4-3-plotting-with-ggplot2.html#cb27-16"></a><span class="kw">print</span>(s)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>We will continue to use this approach throughout the book to plot raw data and model predictions. So, if it is giving you trouble now, spend some extra time with it.</p>
</div>
<div id="ggboxplots" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Boxplots and</h3>
<p>To wrap up our tour of plotting examples in <code>ggplot2</code>, we will reproduce (more or less) the box plots we made in <a href="4-2-base-graphics.html#boxplots">base graphics</a>.</p>
<p>Make the default box plot of surface water temperatures in Otsego Lake, NY. Notice that we use the <code>c_month</code> variable that we made previously in the <code>surface</code> data so R knows these are groups.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="4-3-plotting-with-ggplot2.html#cb28-1"></a>bp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(surface, <span class="kw">aes</span>(<span class="dt">x =</span> c_month, <span class="dt">y =</span> temp)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</span>
<span id="cb28-2"><a href="4-3-plotting-with-ggplot2.html#cb28-2"></a></span>
<span id="cb28-3"><a href="4-3-plotting-with-ggplot2.html#cb28-3"></a><span class="kw">print</span>(bp)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>If we add changes we made to previous plots here, then we can get a cleaner look:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="4-3-plotting-with-ggplot2.html#cb29-1"></a>bp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(surface, <span class="kw">aes</span>(<span class="dt">x =</span> c_month, <span class="dt">y =</span> temp)) <span class="op">+</span></span>
<span id="cb29-2"><a href="4-3-plotting-with-ggplot2.html#cb29-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">color =</span> <span class="st">&#39;gray40&#39;</span>, <span class="dt">fill =</span> <span class="st">&#39;gray87&#39;</span>, <span class="dt">width =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb29-3"><a href="4-3-plotting-with-ggplot2.html#cb29-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="op">+</span></span>
<span id="cb29-4"><a href="4-3-plotting-with-ggplot2.html#cb29-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Temperature ( &quot;</span>, degree, <span class="st">&quot;C)&quot;</span>))) <span class="op">+</span></span>
<span id="cb29-5"><a href="4-3-plotting-with-ggplot2.html#cb29-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb29-6"><a href="4-3-plotting-with-ggplot2.html#cb29-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">-1</span>),</span>
<span id="cb29-7"><a href="4-3-plotting-with-ggplot2.html#cb29-7"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">3</span>),</span>
<span id="cb29-8"><a href="4-3-plotting-with-ggplot2.html#cb29-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()</span>
<span id="cb29-9"><a href="4-3-plotting-with-ggplot2.html#cb29-9"></a>  )</span>
<span id="cb29-10"><a href="4-3-plotting-with-ggplot2.html#cb29-10"></a></span>
<span id="cb29-11"><a href="4-3-plotting-with-ggplot2.html#cb29-11"></a><span class="kw">print</span>(bp)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>And, of course, we can add our “jittered”, raw data points over the top to show the spread.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="4-3-plotting-with-ggplot2.html#cb30-1"></a>bp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(surface, <span class="kw">aes</span>(<span class="dt">x =</span> c_month, <span class="dt">y =</span> temp)) <span class="op">+</span></span>
<span id="cb30-2"><a href="4-3-plotting-with-ggplot2.html#cb30-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">color =</span> <span class="st">&#39;gray40&#39;</span>, <span class="dt">fill =</span> <span class="st">&#39;gray87&#39;</span>, <span class="dt">width =</span> <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb30-3"><a href="4-3-plotting-with-ggplot2.html#cb30-3"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="fl">.5</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb30-4"><a href="4-3-plotting-with-ggplot2.html#cb30-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="op">+</span></span>
<span id="cb30-5"><a href="4-3-plotting-with-ggplot2.html#cb30-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Temperature ( &quot;</span>, degree, <span class="st">&quot;C)&quot;</span>))) <span class="op">+</span></span>
<span id="cb30-6"><a href="4-3-plotting-with-ggplot2.html#cb30-6"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb30-7"><a href="4-3-plotting-with-ggplot2.html#cb30-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">-1</span>),</span>
<span id="cb30-8"><a href="4-3-plotting-with-ggplot2.html#cb30-8"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">3</span>),</span>
<span id="cb30-9"><a href="4-3-plotting-with-ggplot2.html#cb30-9"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()</span>
<span id="cb30-10"><a href="4-3-plotting-with-ggplot2.html#cb30-10"></a>  )</span>
<span id="cb30-11"><a href="4-3-plotting-with-ggplot2.html#cb30-11"></a></span>
<span id="cb30-12"><a href="4-3-plotting-with-ggplot2.html#cb30-12"></a><span class="kw">print</span>(bp)</span></code></pre></div>
<p><img src="worstr_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="4-2-base-graphics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="4-4-next4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["worstr.pdf", "worstr.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
